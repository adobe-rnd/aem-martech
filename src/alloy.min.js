/**
 * Copyright 2019 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

!function(){"use strict";if(document.documentMode&&document.documentMode<11)console.warn("The Adobe Experience Cloud Web SDK does not support IE 10 and below.");else{for(var e,n,t,r,o,i,a,u="Chrome",c="Edge",s="EdgeChromium",d="Unknown",l=function(e,n){return-1!==e.indexOf(n)},f=[u,c,s,"IE",d],p=function(e){return l(f,e)},g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},m=$u(n?e:(n=1,e=Object.assign)),v=function(e){return null==e},h=function(e){return!v(e)&&!Array.isArray(e)&&"object"===cc(e)},y=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.length<2?m.apply(void 0,n):n.reduce((function(e,n){return h(n)&&Object.keys(n).forEach((function(t){var r;Array.isArray(n[t])?Array.isArray(e[t])?(r=e[t]).push.apply(r,ac(n[t])):e[t]=ac(n[t]):e[t]=n[t]})),e}))},w=function e(n,t){function r(e,r,o){if("undefined"!=typeof document){"number"==typeof(o=dc({},t,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=e+"="+n.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},o=0;o<t.length;o++){var i=t[o].split("="),a=i.slice(1).join("=");try{var u=decodeURIComponent(i[0]);if(r[u]=n.read(a,u),e===u)break}catch(e){}}return e?r[e]:r}},remove:function(e,n){r(e,"",dc({},n,{expires:-1}))},withAttributes:function(n){return e(this.converter,dc({},this.attributes,n))},withConverter:function(n){return e(dc({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(n)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),b={get:w.get,set:w.set,remove:w.remove,withConverter:w.withConverter},E=function(e,n){Object.keys(n).forEach((function(t){h(e[t])&&h(n[t])?E(e[t],n[t]):e[t]=n[t]}))},I=function(e){if(v(e))throw new TypeError('deepAssign "target" cannot be null or undefined');for(var n=Object(e),t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach((function(e){return E(n,Object(e))})),n},C=function(e,n){return function(t){var r=n.split(".").reduce((function(e,n){return e[n]=e[n]||{},e[n]}),e);I(r,t)}},S=function(){var e=[];return{add:function(n){e.push(n)},call:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Promise.all(e.map((function(e){return e.apply(void 0,t)})))}}},k=function(e){var n=e.logger,t=e.cookieJar;return rc(rc({},t),{},{set:function(e,r,o){n.info("Setting cookie",rc({name:e,value:r},o)),t.set(e,r,o)}})},T=function(){for(var e=[],n=0;n<256;n++){for(var t=n,r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e.push(t)}return function(n,t){n=unescape(encodeURIComponent(n)),t||(t=0),t=~t;for(var r=0;r<n.length;r++){var o=255&(t^n.charCodeAt(r));t=t>>>8^e[o]}return(t=~t)>>>0}}(),D=function(){var e={};return e.promise=new Promise((function(n,t){e.resolve=n,e.reject=t})),e},P=function(e,n){return e===n},R=function(e,n){for(var t=0;t<e.length;t+=1){var r=e[t];if(n(r,t,e))return r}},O=function(e,n){return e.appendChild(n)},A=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:document).createElement(e);return Object.keys(n).forEach((function(e){o.setAttribute(e,n[e])})),function(e,n){Object.keys(n).forEach((function(t){if("style"===t&&h(n[t])){var r=n[t];Object.keys(r).forEach((function(n){e.style[n]=r[n]}))}else e[t]=n[t]}))}(o,t),r.forEach((function(e){return O(o,e)})),o},N="IMG",M="STYLE",x="SCRIPT",q=function(e){var n=e.src,t=e.currentDocument,r=void 0===t?document:t;return new Promise((function(e,t){A(N,{src:n},{onload:e,onerror:t,onabort:t},[],r)}))},L=function(e){return"function"==typeof e},_=function(e){return Array.isArray(e)&&e.length>0},j=function(e){return Array.isArray(e)?e:null==e?[]:[].slice.call(e)},U=/^\s*>/,F=function(e,n){if(!U.test(n))return j(e.querySelectorAll(n));var t="alloy-"+Date.now();try{return e.classList.add(t),j(e.querySelectorAll("."+t+" "+n))}finally{e.classList.remove(t)}},B=function(e,n){return e.substr(0,n.length)===n},H=":shadow",V=function(e,n){var t=n;return B(t,">")?window.document.documentMode?t.substring(1).trim():(e instanceof Element||e instanceof HTMLDocument?":scope":":host")+" "+t:t},z=function(e,n){if(!window.document.documentElement.attachShadow)return F(e,n.replace(H,""));var t=function(e){return e.split(H)}(n);if(t.length<2)return F(e,n);for(var r=e,o=0;o<t.length;o+=1){var i=t[o].trim();if(""===i&&r.shadowRoot)r=r.shadowRoot;else{var a=V(r,i),u=F(r,a);if(0===u.length||!u[0]||!u[0].shadowRoot)return u;r=u[0].shadowRoot}}},J=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return-1===e.indexOf(H)?F(n,e):z(n,e)},Q="MutationObserver",G={childList:!0,subtree:!0},X=function(e){return new Error("Could not find: "+e)},W=function(e){return new Promise(e)},Y=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=n(e);return _(i)?Promise.resolve(i):function(e){return L(e[Q])}(r)?function(e,n,t,r,o){return W((function(i,a){var u,c=new e[Q]((function(){var e=o(t);_(e)&&(c.disconnect(),u&&clearTimeout(u),i(e))}));u=setTimeout((function(){c.disconnect(),a(X(t))}),r),c.observe(n,G)}))}(r,o,e,t,n):function(e){return"visible"===e.visibilityState}(o)?function(e,n,t,r){return W((function(o,i){var a=function(){var t=r(n);_(t)?o(t):e.requestAnimationFrame(a)};a(),setTimeout((function(){i(X(n))}),t)}))}(r,e,t,n):function(e,n,t){return W((function(r,o){var i=function(){var n=t(e);_(n)?r(n):setTimeout(i,100)};i(),setTimeout((function(){o(X(e))}),n)}))}(e,t,n)},K=function(e){var n=e.parentNode;return n?n.removeChild(e):null},$={name:"Adobe Alloy"},Z={style:{display:"none",width:0,height:0}},ee=function(e){return h(e)&&0===Object.keys(e).length},ne=function(e,n){return v(e)||!h(e)?e:Object.keys(e).reduce((function(t,r){var o=e[r];if(h(o)){var i=ne(o,n);return ee(i)?t:rc(rc({},t),{},nc({},r,i))}return n(o)?rc(rc({},t),{},nc({},r,o)):t}),{})},te=function(e,n){return Array.prototype.concat.apply([],e.map(n))},re="com.adobe.alloy.",oe=re+"getTld",ie="kndctr",ae=function(e){return e.replace("@","_")},ue=function(e,n){return ie+"_"+ae(e)+"_"+n},ce=function(e,n){var t={};return e.forEach((function(e){var r=n(e);t[r]||(t[r]=[]),t[r].push(e)})),t},se=function(e){var n=e.orgId,t=ue(n,"identity");return function(){return Boolean(b.get(t))}},de=function(e,n,t){return{getItem:function(r){try{return e[n].getItem(t+r)}catch(e){return null}},setItem:function(r,o){try{return e[n].setItem(t+r,o),!0}catch(e){return!1}},clear:function(){try{return Object.keys(e[n]).forEach((function(r){B(r,t)&&e[n].removeItem(r)})),!0}catch(e){return!1}}}},le=function(e){return function(n){var t=re+n;return{session:de(e,"sessionStorage",t),persistent:de(e,"localStorage",t)}}},fe=function(e){return"boolean"==typeof e},pe=function(e){return"number"==typeof e&&!isNaN(e)},ge=function(e){var n=parseInt(e,10);return pe(n)&&e===n},me=function(e){return"string"==typeof e},ve=function(e){return me(e)&&e.length>0},he=function(){},ye=function(e,n,t){var r=String(e),o=String(t);if(r.length>=n||0===o.length)return r;for(var i=n-r.length;i>o.length;)o+=o;return o.slice(0,i)+r},we=(r||(r=1,t=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){for(var t={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=t.parser[n.strictMode?"strict":"loose"].exec(e),o={},i=14;i--;)o[t.key[i]]=r[i]||"";return o[t.q.name]={},o[t.key[12]].replace(t.q.parser,(function(e,n,r){n&&(o[t.q.name][n]=r)})),o}}),t),be=$u(we),Ee=function(e){var n={},t=e.split(".");switch(t.length){case 1:n.subdomain="",n.domain=e,n.topLevelDomain="";break;case 2:n.subdomain="",n.domain=e,n.topLevelDomain=t[1];break;case 3:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=t[2];break;case 4:n.subdomain="www"===t[0]?"":t[0],n.domain=e,n.topLevelDomain=t[2]+"."+t[3]}return n},Ie=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ee;me(e)||(e="");var t=be(e)||{},r=t.host,o=void 0===r?"":r,i=t.path,a=void 0===i?"":i,u=t.query,c=void 0===u?"":u,s=t.anchor;return rc({path:a,query:c,fragment:void 0===s?"":s},n(o))},Ce=(i||(i=1,o={parse:function(e){return function(e){var n={};if(!e||"string"!=typeof e)return n;var t=e.trim().replace(/^[?#&]/,""),r=new URLSearchParams(t),o=r.keys();do{var i=o.next(),a=i.value;if(a){var u=r.getAll(a);1===u.length?n[a]=u[0]:n[a]=u}}while(!1===i.done);return n}(e)},stringify:function(e){return function(e){var n="{{space}}",t=new URLSearchParams;return Object.keys(e).forEach((function(r){var o=e[r];"string"==typeof e[r]?o=o.replace(/ /g,n):["object","undefined"].includes(cc(o))&&!Array.isArray(o)&&(o=""),Array.isArray(o)?o.forEach((function(e){t.append(r,e)})):t.append(r,o)})),t.toString().replace(new RegExp(encodeURIComponent(n),"g"),"%20")}(e)}}),o),Se=$u(Ce),ke=function(e){return e instanceof Error?e:new Error(e)},Te=function(e){var n=e.error,t=e.message;try{n.message=t}catch(e){}},De=function(e){var n=e.error,t=e.message,r=ke(n),o=t+"\nCaused by: "+r.message;return Te({error:r,message:o}),r},Pe=function(e,n){if(pe(e)||me(e)){var t=Math.round(Number(e));if(!isNaN(t))return t}return n},Re=[],Oe=0;Oe<256;++Oe)Re.push((Oe+256).toString(16).slice(1));var Ae=new Uint8Array(16),Ne={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},Me=function(e){return function(n,t){return null==n?n:e.call(this,n,t)}},xe=function(e,n){return function(t,r){return n.call(this,e.call(this,t,r),r)}},qe=function(e,n,t){return m(xe(e,n),e,t)},Le=function(e,n,t){return m(xe(e,Me(n)),e,t)},_e=function(e,n,t){return m((r=Me(n),o=e,function(e,n){var t=this,i=[],a=[r,o].reduce((function(e,r){try{return r.call(t,e,n)}catch(n){return i.push(n),e}}),e);if(i.length)throw new Error(i.join("\n"));return a}),e,t);var r,o},je=function(e,n,t,r){if(!e)throw new Error("'"+t+"': Expected "+r+", but got "+JSON.stringify(n)+".")},Ue=function(e,n){return je(fe(e),e,n,"true or false"),e},Fe=function(e,n){return je(L(e),e,n,"a function"),e},Be=function(e,n){return function(t,r){return je(t>=n,t,r,e+" greater than or equal to "+n),t}},He=function(e){return function(n,t){return h(n)?je(!ee(n),n,t,e):je(n.length>0,n,t,e),n}},Ve=function(){return function(e,n){je(function(e){for(var n=Object.create(null),t=0;t<e.length;t+=1){var r=e[t];if(r in n)return!1;n[r]=!0}return!0}(e),e,n,"array values to be unique")}},ze=/^[a-z0-9.-]{1,}$/i,Je=function(e,n){return je(ze.test(e),e,n,"a valid domain"),e},Qe=function(e,n){return je(ge(e),e,n,"an integer"),e},Ge=function(e,n){return je(pe(e),e,n,"a number"),e},Xe=function(e,n){return je(function(e){try{return null!==RegExp(e)}catch(e){return!1}}(e),e,n,"a regular expression"),e},We=function(e,n){if(null==e)throw new Error("'"+n+"' is a required option");return e},Ye=function(e,n){return je(me(e),e,n,"a string"),e},Ke=function(e){return e};Ke.default=function(e){return qe(this,function(e){return function(n){return null==n?e:n}}(e))},Ke.required=function(){return qe(this,We)},Ke.deprecated=function(e){return qe(this,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"This field has been deprecated";return function(n,t){var r=e;return void 0!==n&&(t&&(r="'"+t+"': "+r),this&&this.logger&&this.logger.warn(r)),n}}(e))};var $e=function(){return Le(this,Je)},Ze=function(e){return Le(this,Be("an integer",e))},en=function(e){return Le(this,Be("a number",e))},nn=function(e){return Le(this,(n="a number",t=e,function(e,r){return je(e<=t,e,r,n+" less than or equal to "+t),e}));var n,t},tn=function(){return Le(this,Qe,{minimum:Ze})},rn=function(){return Le(this,He("a non-empty string"))},on=function(){return Le(this,He("a non-empty array"))},an=function(){return Le(this,He("a non-empty object"))},un=function(){return Le(this,Xe)},cn=function(e){return Le(this,function(e){return function(n,t){return je(e.test(n),n,t,"does not match the "+e.toString()),n}}(e))},sn=function(){return Le(this,function(){var e=[];return function(n,t){return je(-1===e.indexOf(n),n,t,"a unique value across instances"),e.push(n),n}}())},dn=function(){return Le(this,Ve())},ln=function(e){return{noUnknownFields:function(){return Le(this,function(e){return function(n,t){var r=[];if(Object.keys(n).forEach((function(n){if(!e[n]){var o=t?t+"."+n:n;r.push("'"+o+"': Unknown field.")}})),r.length)throw new Error(r.join("\n"));return n}}(e))},nonEmpty:an,concat:function(n){var t=rc(rc({},e),n.schema);return Le(this,n,ln(t))},renamed:function(e,n,t){return _e(this,function(e,n,t){return function(r,o){je(h(r),r,o,"an object");var i=r[e],a=r[t],u=oc(r,[e,t].map(uc)),c=n(i,o);if(void 0!==c){var s="The field '"+e+"' is deprecated. Use '"+t+"' instead.";if(o&&(s="'"+o+"': "+s),void 0!==a&&a!==c)throw new Error(s);this&&this.logger&&this.logger.warn(s)}return rc(nc({},t,a||c),u)}}(e,n,t))},schema:e}},fn=function(e,n){return qe(this,function(e,n){return function(t,r){var o,i=this,a=R(e,(function(e){try{return o=e.call(i,t,r),!0}catch(e){return!1}}));return je(a,t,r,n),o}}(e,n))}.bind(Ke),pn=function(){return this}.bind(Ke),gn=function(e){return Le(this,function(e){return function(n,t){var r=this;je(Array.isArray(n),n,t,"an array");var o=[],i=n.map((function(i,a){try{return e.call(r,i,t+"["+a+"]",n)}catch(e){return void o.push(e.message)}}));if(o.length)throw new Error(o.join("\n"));return i}}(e),{nonEmpty:on,uniqueItems:dn})}.bind(Ke),mn=function(){return Le(this,Ue)}.bind(Ke),vn=function(){return Le(this,Fe)}.bind(Ke),hn=function(e){return Le(this,function(e){return function(n,t){return je(n===e,n,t,""+e),n}}(e))}.bind(Ke),yn=function(){return Le(this,Ge,{minimum:en,maximum:nn,integer:tn,unique:sn})}.bind(Ke),wn=function(e){return Le(this,(n=e,function(e,t){var r=this;je(h(e),e,t,"an object");var o=[],i={};if(Object.keys(e).forEach((function(a){var u=e[a],c=t?t+"."+a:a;try{var s=n.call(r,u,c);void 0!==s&&(i[a]=s)}catch(e){o.push(e.message)}})),o.length)throw new Error(o.join("\n"));return i}),{nonEmpty:an});var n}.bind(Ke),bn=function(e){return Le(this,function(e){return function(n,t){var r=this;je(h(n),n,t,"an object");var o=[],i={};if(Object.keys(e).forEach((function(a){var u=n[a],c=e[a],s=t?t+"."+a:a;try{var d=c.call(r,u,s);void 0!==d&&(i[a]=d)}catch(e){o.push(e.message)}})),Object.keys(n).forEach((function(e){Object.prototype.hasOwnProperty.call(i,e)||(i[e]=n[e])})),o.length)throw new Error(o.join("\n"));return i}}(e),ln(e))}.bind(Ke),En=function(){return Le(this,Ye,{regexp:un,domain:$e,nonEmpty:rn,unique:sn,matches:cn})}.bind(Ke),In=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return fn(n.map(hn),"one of these values: ["+JSON.stringify(n)+"]")},Cn=wn(gn(bn({authenticatedState:In("ambiguous","authenticated","loggedOut"),id:En(),namespace:bn({code:En()}).noUnknownFields(),primary:mn(),xid:En()}).noUnknownFields()).required()),Sn=bn({}),kn=function(e){return Object.keys(e).map((function(n){return e[n]}))},Tn="alloy_debug",Dn=function(e){var n,t=e.console,r=e.locationSearch,o=e.createLogger,i=e.instanceName,a=e.createNamespacedStorage,u=e.getMonitors,c=Se.parse(r),s=a("instance."+i+"."),d=s.session.getItem("debug"),l="true"===d,f=null===d,p=function(){return l},g=function(e,n){var t=n.fromConfig;t&&!f||(l=e),t||(s.session.setItem("debug",e.toString()),f=!1)};return void 0!==c[Tn]&&g((n=c[Tn],me(n)&&"true"===n.toLowerCase()),{fromConfig:!1}),{setDebugEnabled:g,logger:o({getDebugEnabled:p,context:{instanceName:i},getMonitors:u,console:t}),createComponentLogger:function(e){return o({getDebugEnabled:p,context:{instanceName:i,componentName:e},getMonitors:u,console:t})}}},Pn=["onComponentsRegistered","onBeforeEvent","onBeforeRequest","onResponse","onRequestFailure","onClick","onDecision"],Rn=function(e){return Pn.reduce((function(n,t){var r;return n[t]=(r=function(e,n){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Promise.all(e.getLifecycleCallbacks(n).map((function(e){return new Promise((function(n){n(e.apply(void 0,r))}))})))}}(e,t),function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Promise.resolve().then((function(){return r.apply(void 0,n)}))}),n}),{})},On=function(e,n){return function(){var t;try{t=e.apply(void 0,arguments)}catch(e){throw De({error:e,message:n})}return t instanceof Promise&&(t=t.catch((function(e){throw De({error:e,message:n})}))),t}},An=function(){var e={},n={},t={},r=function(e){var t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(t=Object.keys(n),r=Object.keys(o),t.filter((function(e){return l(r,e)})));if(i.length)throw new Error("[ComponentRegistry] Could not register "+e+" because it has existing command(s): "+i.join(","));Object.keys(o).forEach((function(t){var r=o[t];r.commandName=t,r.run=On(r.run,"["+e+"] An error occurred while executing the "+t+" command."),n[t]=r}))};return{register:function(n,o){var i=o.commands,a=o.lifecycle;r(n,i),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(n).forEach((function(r){t[r]=t[r]||[],t[r].push(On(n[r],"["+e+"] An error occurred while executing the "+r+" lifecycle hook."))}))}(n,a),e[n]=o},getCommand:function(e){return n[e]},getCommandNames:function(){return Object.keys(n)},getLifecycleCallbacks:function(e){return t[e]||[]},getComponentNames:function(){return Object.keys(e)}}},Nn="in",Mn="out",xn="pending",qn="general",Ln="declinedConsent",_n="default",jn="initial",Un="new",Fn=function(e){var n=new Error(e);return n.code=Ln,n.message=e,n},Bn=function(e){var n=e.logger,t=[],r=function(){return Promise.resolve()},o=function(){return Promise.resolve()},i=function(){return Promise.reject(Fn("No consent preferences have been set."))},a=function(){return Promise.reject(Fn("The user declined consent."))},u=function(e){if(e)return Promise.reject(new Error("Consent is pending."));var n=D();return t.push(n),n.promise};return{in:function(e){e===_n?this.awaitConsent=r:(e===jn?n.info("Loaded user consent preferences. The user previously consented."):e===Un&&this.awaitConsent!==o&&n.info("User consented."),function(){for(;t.length;)t.shift().resolve()}(),this.awaitConsent=o)},out:function(e){e===_n?(n.warn("User consent preferences not found. Default consent of out will be used."),this.awaitConsent=i):(e===jn?n.warn("Loaded user consent preferences. The user previously declined consent."):e===Un&&this.awaitConsent!==a&&n.warn("User declined consent."),function(){for(;t.length;)t.shift().reject(Fn("The user declined consent."))}(),this.awaitConsent=a)},pending:function(e){e===_n&&n.info("User consent preferences not found. Default consent of pending will be used. Some commands may be delayed."),this.awaitConsent=u},awaitConsent:function(){return Promise.reject(new Error("Consent has not been initialized."))},withConsent:function(){return this.awaitConsent(!0)},current:function(){switch(this.awaitConsent){case r:return{state:"in",wasSet:!1};case o:return{state:"in",wasSet:!0};case i:return{state:"out",wasSet:!1};case a:return{state:"out",wasSet:!0};case u:return{state:"pending",wasSet:!1};default:return{state:"in",wasSet:!1}}}}},Hn=function(e){return e&&e._experience&&e._experience.decisioning&&_(e._experience.decisioning.propositions)?e._experience.decisioning.propositions:[]},Vn=function(){var e,n,t={},r=!1,o=!1,i=!0,a=function(e){if(o)throw new Error(e+" cannot be called after event is finalized.")},u={hasQuery:function(){return Object.prototype.hasOwnProperty.call(this.getContent(),"query")},getContent:function(){var r=JSON.parse(JSON.stringify(t));return e&&I(r,{xdm:e}),n&&I(r,{data:n}),r},setUserXdm:function(n){a("setUserXdm"),e=n},setUserData:function(e){a("setUserData"),n=e},mergeXdm:function(e){a("mergeXdm"),e&&I(t,{xdm:e})},mergeData:function(e){a("mergeData"),e&&I(t,{data:e})},mergeMeta:function(e){a("mergeMeta"),e&&I(t,{meta:e})},mergeQuery:function(e){a("mergeQuery"),e&&I(t,{query:e})},documentMayUnload:function(){r=!0},finalize:function(r){if(!o){var a=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P;return e.filter((function(t,r){return function(e,n,t){for(var r=0;r<e.length;r+=1)if(t(e[r],n))return r;return-1}(e,t,n)===r}))}([].concat(ac(Hn(e)),ac(Hn(t.xdm))),(function(e,n){return e===n||e.id&&n.id&&e.id===n.id&&e.scope&&n.scope&&e.scope===n.scope}));if(e&&this.mergeXdm(e),a.length>0&&(t.xdm._experience.decisioning.propositions=a),n&&u.mergeData(n),o=!0,r){i=!1;var c={xdm:t.xdm||{},data:t.data||{}},s=r(c);i=!1!==s,t.xdm=c.xdm||{},t.data=c.data||{},ee(t.xdm)&&delete t.xdm,ee(t.data)&&delete t.data}}},getDocumentMayUnload:function(){return r},isEmpty:function(){return ee(t)&&(!e||ee(e))&&(!n||ee(n))},shouldSend:function(){return i},getViewName:function(){if(e&&e.web&&e.web.webPageDetails)return e.web.webPageDetails.viewName},toJSON:function(){if(!o)throw new Error("toJSON called before finalize");return t}};return u},zn="configure",Jn="setDebug",Qn=function(e){var n,t=e.logger,r=e.configureCommand,o=e.setDebugCommand,i=e.handleError,a=e.validateCommandOptions;return function(e){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(i){var c=function(e,i){var u;if(e===zn){if(n)throw new Error("The library has already been configured and may only be configured once.");u=function(){return(n=r(i)).then((function(){}))}}else{if(!n)throw new Error("The library must be configured first. Please do so by executing the configure command.");u=e===Jn?function(){return o(i)}:function(){return n.then((function(n){var t=n.getCommand(e);if(!t||!L(t.run)){var r=[zn,Jn].concat(n.getCommandNames()).join(", ");throw new Error("The "+e+" command does not exist. List of available commands: "+r+".")}var o=a({command:t,options:i});return t.run(o)}),(function(){return t.warn("An error during configuration is preventing the "+e+" command from executing."),new Promise((function(){}))}))}}return u}(e,u);t.logOnBeforeCommand({commandName:e,options:u}),i(c())})).catch((function(n){return i(n,e+" command")})).catch((function(n){throw t.logOnCommandRejected({commandName:e,options:u,error:n}),n})).then((function(n){var r=h(n)?n:{};return t.logOnCommandResolved({commandName:e,options:u,result:r}),r}))}},Gn=function(e){var n=e.command,t=e.options,r=n.commandName,o=n.documentationUri,i=void 0===o?"https://adobe.ly/3sHgQHb":o,a=n.optionsValidator,u=t;if(a)try{u=a(t)}catch(e){throw new Error("Invalid "+r+" command options:\n\t - "+e+" For command documentation see: "+i)}return u},Xn=["xdm","data","documentUnloading","type","mergeId","datasetId","edgeConfigOverrides"],Wn=function(e){var n=e.eventManager,t=e.logger;return{commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:function(e){return function(e){var n=e.options;return bn({type:En(),xdm:bn({eventType:En(),identityMap:Cn}),data:bn({}),documentUnloading:mn(),renderDecisions:mn(),decisionScopes:gn(En()).uniqueItems(),personalization:bn({decisionScopes:gn(En()).uniqueItems(),surfaces:gn(En()).uniqueItems(),sendDisplayEvent:mn().default(!0),includeRenderedPropositions:mn().default(!1),defaultPersonalizationEnabled:mn(),decisionContext:bn({})}).default({sendDisplayEvent:!0}),datasetId:En(),mergeId:En(),edgeConfigOverrides:Sn,initializePersonalization:mn()}).required().noUnknownFields()(n)}({options:e})},run:function(e){var r=e.xdm,o=e.data,i=e.documentUnloading,a=e.type,u=e.mergeId,c=e.datasetId,s=e.edgeConfigOverrides,d=oc(e,Xn),l=n.createEvent();return i&&l.documentMayUnload(),l.setUserXdm(r),l.setUserData(o),a&&l.mergeXdm({eventType:a}),u&&l.mergeXdm({eventMergeId:u}),s&&(d.edgeConfigOverrides=s),c&&(t.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.com_adobe_experience_platform.datasets.event.datasetId' instead."),d.edgeConfigOverrides=s||{},I(d.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:c}}}})),n.sendEvent(l,d)}},applyResponse:{documentationUri:"",optionsValidator:function(e){return function(e){var n=e.options;return bn({renderDecisions:mn(),responseHeaders:wn(En().required()),responseBody:bn({handle:gn(bn({type:En().required(),payload:pn().required()})).required()}).required(),personalization:bn({sendDisplayEvent:mn().default(!0),decisionContext:bn({})}).default({sendDisplayEvent:!0})}).noUnknownFields()(n)}({options:e})},run:function(e){var t=e.renderDecisions,r=void 0!==t&&t,o=e.decisionContext,i=void 0===o?{}:o,a=e.responseHeaders,u=void 0===a?{}:a,c=e.responseBody,s=void 0===c?{handle:[]}:c,d=e.personalization,l=n.createEvent();return n.applyResponse(l,{renderDecisions:r,decisionContext:i,responseHeaders:u,responseBody:s,personalization:d})}}}}};Wn.namespace="DataCollector";var Yn,Kn=function(e){var n=function(e){var n=e.eventManager,t=e.lifecycle,r=e.handleError;return function(e){if(e.s_fe)return Promise.resolve();var o=e.target,i=n.createEvent();return i.documentMayUnload(),t.onClick({event:i,clickedElement:o}).then((function(){return i.isEmpty()?Promise.resolve():n.sendEvent(i)})).then(he).catch((function(e){r(e,"click collection")}))}}({eventManager:e.eventManager,lifecycle:e.lifecycle,handleError:e.handleError});document.addEventListener("click",n,!0)},$n=En().regexp().default("\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$"),Zn=bn({clickCollectionEnabled:mn().default(!0),clickCollection:bn({internalLinkEnabled:mn().default(!0),externalLinkEnabled:mn().default(!0),downloadLinkEnabled:mn().default(!0),sessionStorageEnabled:mn().default(!1),eventGroupingEnabled:mn().default(!1),filterClickProperties:vn()}).default({internalLinkEnabled:!0,externalLinkEnabled:!0,downloadLinkEnabled:!0,sessionStorageEnabled:!1,eventGroupingEnabled:!1}),downloadLinkQualifier:$n,onBeforeLinkClickSend:vn().deprecated('The field "onBeforeLinkClickSend" has been deprecated. Use "clickCollection.filterClickDetails" instead.')}),et=function(){return null!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).getElementById("cppXYctnr")},nt=function(e){var n=e;return/^https?:\/\//i.test(n)||(n=window.location.protocol+"//"+e),new URL(n).hostname},tt=function(e){var n=e.config,t=e.logger,r=e.getClickedElementProperties,o=e.clickActivityStorage,i=n.clickCollectionEnabled,a=n.clickCollection;return i?function(e){var i,u,c=e.event,s=e.clickedElement,d=r({clickActivityStorage:o,clickedElement:s,config:n,logger:t}),l=d.linkType;et()||(d.isValidLink()&&function(e,n){return n&&("download"===n&&!e.downloadLinkEnabled||"exit"===n&&!e.externalLinkEnabled||"other"===n&&!e.internalLinkEnabled)}(a,l)?t.info("Cancelling link click event due to clickCollection."+l+"LinkEnabled = false."):d.isInternalLink()&&a.eventGroupingEnabled&&(!n.onBeforeLinkClickSend||a.filterClickDetails)&&(i=window.location.hostname,u=d.linkUrl,nt(i)===nt(u))?o.save(d.properties):d.isValidLink()?(c.mergeXdm(d.xdm),c.mergeData(d.data),o.save({pageName:d.pageName,pageIDType:d.pageIDType})):d.isValidActivityMapData()&&o.save(d.properties))}:function(){}},rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.properties,t=e.logger,r=n||{};return{get pageName(){return r.pageName},set pageName(e){r.pageName=e},get linkName(){return r.linkName},set linkName(e){r.linkName=e},get linkRegion(){return r.linkRegion},set linkRegion(e){r.linkRegion=e},get linkType(){return r.linkType},set linkType(e){r.linkType=e},get linkUrl(){return r.linkUrl},set linkUrl(e){r.linkUrl=e},get pageIDType(){return r.pageIDType},set pageIDType(e){r.pageIDType=e},get clickedElement(){return r.clickedElement},set clickedElement(e){r.clickedElement=e},get properties(){return{pageName:r.pageName,linkName:r.linkName,linkRegion:r.linkRegion,linkType:r.linkType,linkUrl:r.linkUrl,pageIDType:r.pageIDType}},isValidLink:function(){return!!(r.linkUrl&&r.linkType&&r.linkName&&r.linkRegion)},isInternalLink:function(){return this.isValidLink()&&"other"===r.linkType},isValidActivityMapData:function(){return!!r.pageName&&!!r.linkName&&!!r.linkRegion&&void 0!==r.pageIDType},get xdm(){return r.filteredXdm?r.filteredXdm:function(e){return{eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:e.linkName,region:e.linkRegion,type:e.linkType,URL:e.linkUrl,linkClicks:{value:1}}}}}(this)},get data(){return r.filteredData?r.filteredData:function(e){return{__adobe:{analytics:{contextData:{a:{activitymap:{page:e.pageName,link:e.linkName,region:e.linkRegion,pageIDType:e.pageIDType}}}}}}}(this)},applyPropertyFilter:function(e){e&&!1===e(r)&&(t&&t.info("Clicked element properties were rejected by filter function: "+JSON.stringify(this.properties,null,2)),r={})},applyOptionsFilter:function(e){var n=this.options;if(n&&n.clickedElement&&(n.xdm||n.data)){if(e&&!1===e(n))return t&&t.info("Clicked element properties were rejected by filter function: "+JSON.stringify(this.properties,null,2)),void(this.options=void 0);this.options=n,r.filteredXdm=n.xdm,r.filteredData=n.data}},get options(){var e={};if(this.isValidLink()&&(e.xdm=this.xdm),this.isValidActivityMapData()&&(e.data=this.data),this.clickedElement&&(e.clickedElement=this.clickedElement),e.xdm||e.data)return e},set options(e){r={},e&&function(e,n){var t=e.xdm,r=e.data,o=e.clickedElement;if(n.clickedElement=o,t&&t.web&&t.web.webInteraction){var i=t.web.webInteraction,a=i.name,u=i.region,c=i.type,s=i.URL;n.linkName=a,n.linkRegion=u,n.linkType=c,n.linkUrl=s}if(r&&r.__adobe&&r.__adobe.analytics){var d=r.__adobe.analytics.contextData;if(d&&d.a&&d.a.activitymap){var l=d.a.activitymap,f=l.page,p=l.link,g=l.region,m=l.pageIDType;n.pageName=f||n.pageName,n.linkName=p||n.linkName,n.linkRegion=g||n.linkRegion,void 0!==m&&(n.pageIDType=m)}}}(e,r)}}},ot="clickData",it=function(e){return e&&e.replace(/\s+/g," ").trim()},at=/^(SCRIPT|STYLE|LINK|CANVAS|NOSCRIPT|#COMMENT)$/i,ut=function(e){var n=[],t=!1;(function(e){return!(e&&e.nodeName&&e.nodeName.match(at))})(e)?(n.push(e),e.childNodes&&Array.prototype.slice.call(e.childNodes).forEach((function(e){var r=ut(e);n=n.concat(r.supportedNodes),t=t||r.includesUnsupportedNodes}))):t=!0;return{supportedNodes:n,includesUnsupportedNodes:t}},ct=function(e,n,t){var r;return t&&t!==e.nodeName.toUpperCase()||(r=e.getAttribute(n)),r},st=/^(HEADER|MAIN|FOOTER|NAV)$/i,dt=function(e){var n;return"region"===e.role&&ve(e["aria-label"])&&(n=e["aria-label"]),n},lt=function(e){var n;return e&&e.nodeName&&e.nodeName.match(st)&&(n=e.nodeName),n},ft=function(e){return!(!e.href||"A"!==e.tagName&&"AREA"!==e.tagName||e.onclick&&e.protocol&&!(e.protocol.toLowerCase().indexOf("javascript")<0))},pt=function(e){return!!e&&!!e.onclick},gt=function(e){if("INPUT"===e.tagName){var n=e.getAttribute("type");if("submit"===n)return!0;if("image"===n&&e.src)return!0}return!1},mt=function(e){return"BUTTON"===e.tagName&&"submit"===e.type},vt=function(e){var n=e.indexOf("?"),t=e.indexOf("#");return n>=0&&(n<t||t<0)?e.substring(0,n):t>=0?e.substring(0,t):e},ht=function(e){var n=e.window,t=e.getLinkName,r=e.getLinkRegion,o=e.getAbsoluteUrlFromAnchorElement,i=e.findClickableElement,a=e.determineLinkType;return function(e){var u=e.clickedElement,c=e.config,s=e.logger,d=e.clickActivityStorage,l=c.onBeforeLinkClickSend,f=c.clickCollection.filterClickDetails,p=rt({logger:s});if(u){var g=i(u);if(g){p.clickedElement=u,p.linkUrl=o(n,g),p.linkType=a(n,c,p.linkUrl,g),p.linkRegion=r(g),p.linkName=t(g),p.pageIDType=0,p.pageName=n.location.href;var m=d.load();m&&m.pageName&&(p.pageName=m.pageName,p.pageIDType=1),f?p.applyPropertyFilter(f):l&&p.applyOptionsFilter(l)}}return p}}({window:window,getLinkName:function(e){var n=it(e.innerText||e.textContent),t=ut(e);if(!n||t.includesUnsupportedNodes){var r=function(e){var n={texts:[]};return e.supportedNodes.forEach((function(e){e.getAttribute&&(n.alt||(n.alt=it(e.getAttribute("alt"))),n.title||(n.title=it(e.getAttribute("title"))),n.inputValue||(n.inputValue=it(ct(e,"value","INPUT"))),n.imgSrc||(n.imgSrc=it(ct(e,"src","IMG")))),e.nodeValue&&n.texts.push(e.nodeValue)})),n}(t);(n=it(r.texts.join("")))||(n=r.alt||r.title||r.inputValue||r.imgSrc)}return n||""},getLinkRegion:function(e){for(var n,t=e.parentNode;t;){if(n=it(t.id||dt(t)||lt(t)))return n;t=t.parentNode}return"BODY"},getAbsoluteUrlFromAnchorElement:function(e,n){var t=e.location,r=n.href||"";"string"!=typeof r&&(r="");var o,i=n.protocol,a=n.host;if(r&&(!(o=r)||!/^[a-z0-9]+:\/\//i.test(o))){i||(i=t.protocol?t.protocol:""),i=i?i+"//":"",a||(a=t.host?t.host:"");var u="";if("/"!==r.substring(0,1)){var c=t.pathname.lastIndexOf("/");c=c<0?0:c,u=t.pathname.substring(0,c)}r=""+i+a+u+"/"+r}return r},findClickableElement:function(e){for(var n=e;n;){if(ft(n)||pt(n)||gt(n)||mt(n))return n;n=n.parentNode}return null},determineLinkType:function(e,n,t,r){var o="other";return ve(t)&&(!function(e,n,t){var r=!1;if(n)if(t&&t.download)r=!0;else if(e){var o=new RegExp(e),i=vt(n).toLowerCase();r=o.test(i)}return r}(n.downloadLinkQualifier,t,r)?function(e,n){var t=!1;if(n&&e.location.hostname){var r=e.location.hostname.toLowerCase();t=vt(n).toLowerCase().indexOf(r)<0}return t}(e,t)&&(o="exit"):o="download"),o}}),yt=function(e){var n=e.config,t=e.eventManager,r=e.handleError,o=e.logger,i=n.clickCollection,a=le(window)(n.orgId||""),u=function(){var e={};return{getItem:function(n){return e[n]},setItem:function(n,t){e[n]=t},removeItem:function(n){delete e[n]}}}(),c=i.sessionStorageEnabled?a.session:u;Yn=function(e){var n=e.storage;return{save:function(e){var t=JSON.stringify(e);n.setItem(ot,t)},load:function(){var e=null,t=n.getItem(ot);return t&&(e=JSON.parse(t)),e},remove:function(){n.removeItem(ot)}}}({storage:c});var s=tt({config:n,logger:o,clickActivityStorage:Yn,getClickedElementProperties:ht}),d=function(e){var n=e.clickActivityStorage;return function(e){if(!et()){var t=n.load(),r=rt({properties:t});if(r.isValidLink()||r.isValidActivityMapData()){if(r.isValidLink()){var o=r.xdm;delete o.eventType,e.mergeXdm(o)}r.isValidActivityMapData()&&e.mergeData(r.data),n.save({pageName:r.pageName,pageIDType:r.pageIDType})}}}}({clickActivityStorage:Yn}),l=function(e){var n=e.clickActivityStorage;return function(e){n.save({pageName:e.getContent().xdm.web.webPageDetails.name,pageIDType:1})}}({clickActivityStorage:Yn});return{lifecycle:{onComponentsRegistered:function(e){var n=e.lifecycle;Kn({eventManager:t,lifecycle:n,handleError:r})},onClick:function(e){var n=e.event,t=e.clickedElement;s({event:n,clickedElement:t})},onBeforeEvent:function(e){var n=e.event;(function(e){var n=e.getContent();return void 0!==n.xdm&&void 0!==n.xdm.web&&void 0!==n.xdm.web.webPageDetails&&void 0!==n.xdm.web.webPageDetails.name})(n)&&(i.eventGroupingEnabled&&d(n),l(n,o,Yn))}}}};yt.namespace="ActivityCollector",yt.configValidators=Zn,yt.buildOnInstanceConfiguredExtraParams=function(e){var n=e.config,t=e.logger;return{getLinkDetails:function(e){return ht({clickActivityStorage:Yn,clickedElement:e,config:n,logger:t}).properties}}};var wt,bt,Et=function(e,n){return"ID sync "+(n?"succeeded":"failed")+": "+e.spec.url},It=bn({thirdPartyCookiesEnabled:mn().default(!0),idMigrationEnabled:mn().default(!0)}),Ct=bn({namespaces:gn(hn("ECID")).nonEmpty().uniqueItems().default(["ECID"]),edgeConfigOverrides:Sn}).noUnknownFields().default({namespaces:["ECID"]}),St=bn({url:En().required().nonEmpty(),edgeConfigOverrides:Sn}).required().noUnknownFields(),kt=function(e){var n=e.logger;return new Promise((function(e,t){if(h(window.adobe)&&h(window.adobe.optIn)){var r=window.adobe.optIn;n.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),r.fetchPermissions((function(){r.isApproved([r.Categories.ECID])?(n.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),e()):t(new Error("Legacy opt-in was declined."))}),!0)}else e()}))},Tt=function(e){var n=e.logger,t=e.orgId,r=e.awaitVisitorOptIn;return function(){var e=function(e){var n=e.Visitor;return L(n)&&L(n.getInstance)&&n}(window);return e?r({logger:n}).then((function(){return n.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise((function(r){e.getInstance(t,{}).getMarketingCloudVisitorID((function(e){n.info("Resuming previously delayed request that was waiting for ECID from Visitor."),r(e)}),!0)}))})).catch((function(e){e?n.info(e.message+", retrieving ECID from experience edge"):n.info("An error occurred while obtaining the ECID from Visitor.")})):Promise.resolve()}},Dt="ECID",Pt=function(e){e.mergeQuery({identity:{fetch:[Dt]}})},Rt=(wt=function(e){return(n=nc(nc(nc(nc(nc(nc({},c,/Edge\/([0-9\._]+)/),s,/Edg\/([0-9\.]+)/),u,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/),"Firefox",/Firefox\/([0-9\.]+)(?:\s|$)/),"IE",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/),"Safari",/Version\/([0-9\._]+).*Safari/),function(e){for(var t=Object.keys(n),r=0;r<t.length;r+=1){var o=t[r];if(n[o].test(e))return o}return d})(e.navigator.userAgent);var n},bt=new Map,function(){var e=arguments.length<=0?void 0:arguments[0];if(bt.has(e))return bt.get(e);var n=wt.apply(void 0,arguments);return bt.set(e,n),n}),Ot=function(e,n){e.addIdentity(Dt,{id:n})},At=function(e){var n=e.getPayloadsByType("identity:result"),t=R(n,(function(e){return e.namespace&&e.namespace.code===Dt}));return t?t.id:void 0},Nt=function(e){return function(n,t){e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(t)}},Mt=function(e){var n=e.payload,t=e.getAction,r=e.getUseSendBeacon,o=e.datastreamIdOverride,i=e.edgeSubPath,a=fc(),u=!1,c=!1;return{getId:function(){return a},getPayload:function(){return n},getAction:function(){return t({isIdentityEstablished:c})},getDatastreamIdOverride:function(){return o},getUseSendBeacon:function(){return r({isIdentityEstablished:c})},getEdgeSubPath:function(){return i||""},getUseIdThirdPartyDomain:function(){return u},setUseIdThirdPartyDomain:function(){u=!0},setIsIdentityEstablished:function(){c=!0}}},xt=function(e){var n=e.payload,t=e.datastreamIdOverride,r=function(e){var t=e.isIdentityEstablished;return n.getDocumentMayUnload()&&t};return Mt({payload:n,getAction:function(e){var n=e.isIdentityEstablished;return r({isIdentityEstablished:n})?"collect":"interact"},getUseSendBeacon:r,datastreamIdOverride:t})},qt=function(e){var n=e.content,t=e.addIdentity,r=e.hasIdentity,o=C(n,"meta.configOverrides");return{mergeMeta:C(n,"meta"),mergeState:C(n,"meta.state"),mergeQuery:C(n,"query"),mergeConfigOverride:function(e){return o(function(e){if(v(e)||"object"!==cc(e))return null;var n=ne(e,(function(e){return!(v(e)||!fe(e)&&!pe(e)&&!ve(e)&&!_(e))}));return ee(n)?null:n}(e))},addIdentity:t,hasIdentity:r,toJSON:function(){return n}}},Lt=function(e){return function(n){return void 0!==(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[n])}},_t=function(){var e={},n=qt({content:e,addIdentity:Nt(e),hasIdentity:Lt(e)});return n.addEvent=function(n){e.events=e.events||[],e.events.push(n)},n.getDocumentMayUnload=function(){return(e.events||[]).some((function(e){return e.getDocumentMayUnload()}))},n},jt=["datastreamId"],Ut=function(e){var n=e.localConfigOverrides,t=e.globalConfigOverrides,r=e.payload,o={payload:r},i=n||{},a=i.datastreamId,u=oc(i,jt);return a&&(o.datastreamIdOverride=a),r.mergeConfigOverride(t),r.mergeConfigOverride(u),o},Ft="clientId",Bt=function(e){var n=e.payload,t=e.datastreamIdOverride;return Mt({payload:n,datastreamIdOverride:t,getAction:function(){return"identity/acquire"},getUseSendBeacon:function(){return!1}})},Ht=function(e){var n={query:{identity:{fetch:e}}};return qt({content:n,addIdentity:Nt(n),hasIdentity:Lt(n)})},Vt=/^([^?#]*)(\??[^#]*)(#?.*)$/,zt=function(e){var n=e.config,t=e.logger,r=e.consent,o=e.fireReferrerHideableImage,i=e.sendEdgeNetworkRequest,a=e.apexDomain,u=n.orgId,c=n.thirdPartyCookiesEnabled,s=n.edgeConfigOverrides,d=function(e){var n=e.config,t=e.getEcidFromVisitor,r=e.apexDomain,o=e.isPageSsl,i=e.cookieJar,a=n.idMigrationEnabled,u="AMCV_"+n.orgId,c=function(){var e=null,n=i.get("s_ecid")||i.get(u);if(n){var t=n.match(/(^|\|)MCMID\|(\d+)($|\|)/);t&&(e=t[2])}return e};return{getEcid:function(){if(a){var e=c();return e?Promise.resolve(e):t()}return Promise.resolve()},setEcid:function(e){if(a&&c()!==e){var n=o?{sameSite:"none",secure:!0}:{};i.set(u,"MCMID|"+e,rc({domain:r,expires:390},n))}}}}({config:n,getEcidFromVisitor:Tt({logger:t,orgId:u,awaitVisitorOptIn:kt}),apexDomain:a,cookieJar:k({logger:t,cookieJar:b}),isPageSsl:"https:"===window.location.protocol}),l=se({orgId:u}),f=function(e){var n=e.sendEdgeNetworkRequest,t=e.createIdentityRequestPayload,r=e.createIdentityRequest,o=e.globalConfigOverrides;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.namespaces,a=e.edgeConfigOverrides,u=Ut({payload:t(i),globalConfigOverrides:o,localConfigOverrides:a}),c=r(u);return n({request:c})}}({sendEdgeNetworkRequest:i,createIdentityRequestPayload:Ht,createIdentityRequest:Bt,globalConfigOverrides:s}),g=function(e){var n=e.thirdPartyCookiesEnabled,t=e.areThirdPartyCookiesSupportedByDefault;return function(e){n&&t(Rt(window))&&e.setUseIdThirdPartyDomain()}}({thirdPartyCookiesEnabled:c,areThirdPartyCookiesSupportedByDefault:p}),v=function(e){var n=e.getLegacyEcid,t=e.addEcidToPayload;return function(e){return e.hasIdentity(Dt)?Promise.resolve():n().then((function(n){n&&t(e,n)}))}}({getLegacyEcid:d.getEcid,addEcidToPayload:Ot}),h=function(e){var n=e.locationSearch,t=e.dateProvider,r=e.orgId,o=e.logger;return function(e){if(!e.hasIdentity(Dt)){var i=Se.parse(n).adobe_mc;if(void 0!==i){Array.isArray(i)&&(o.warn("Found multiple adobe_mc query string paramters, only using the last one."),i=i[i.length-1]);var a=i.split("|").reduce((function(e,n){var t=ic(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{}),u=parseInt(a.TS,10),c=a.MCMID,s=decodeURIComponent(a.MCORGID);t().getTime()/1e3<=u+300&&s===r&&c?(o.info("Found valid ECID identity "+c+" from the adobe_mc query string parameter."),e.addIdentity(Dt,{id:c})):o.info("Detected invalid or expired adobe_mc query string parameter.")}}}}({locationSearch:window.document.location.search,dateProvider:function(){return new Date},orgId:u,logger:t}),y=function(e){var n=e.doesIdentityCookieExist,t=e.orgId,r=e.logger;return function(e){var o=e.onResponse,i=e.onRequestFailure;return new Promise((function(e,a){o((function(){n()?e():(r.warn("Identity cookie not found. This could be caused by any of the following issues:\n\t* The org ID "+t+" configured in Alloy doesn't match the org ID specified in the edge configuration.\n\t* Experience edge was not able to set the identity cookie due to domain or cookie restrictions.\n\t* The request was canceled by the browser and not fully processed."),a(new Error("Identity cookie not found.")))})),i((function(){n()?e():a(new Error("Identity cookie not found."))}))}))}}({doesIdentityCookieExist:l,orgId:u,logger:t}),w=function(e){var n,t=e.doesIdentityCookieExist,r=e.setDomainForInitialIdentityPayload,o=e.addLegacyEcidToPayload,i=e.awaitIdentityCookie,a=e.logger,u=function(e){return r(e),o(e.getPayload())};return function(e){var r=e.request,o=e.onResponse,c=e.onRequestFailure;if(t())return r.setIsIdentityEstablished(),Promise.resolve();if(n){a.info("Delaying request while retrieving ECID from server.");var s=n;return n=s.catch((function(){return i({onResponse:o,onRequestFailure:c})})),s.then((function(){a.info("Resuming previously delayed request."),r.setIsIdentityEstablished()})).catch((function(){return u(r)}))}return(n=i({onResponse:o,onRequestFailure:c})).catch((function(){})),u(r)}}({doesIdentityCookieExist:l,setDomainForInitialIdentityPayload:g,addLegacyEcidToPayload:v,awaitIdentityCookie:y,logger:t}),E=function(e){var n=e.fireReferrerHideableImage,t=e.logger;return function(e){var r=e.filter((function(e){return"url"===e.type}));return r.length?Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(Et(e,!0))})).catch((function(){t.error(Et(e,!1))}))}))).then(he):Promise.resolve()}}({fireReferrerHideableImage:o,logger:t}),I=function(e){var n=e.processIdSyncs;return function(e){return n(e.getPayloadsByType("identity:exchange"))}}({processIdSyncs:E}),C=function(e){var n=e.dateProvider,t=e.orgId;return function(e,r){var o=Math.round(n().getTime()/1e3),i=encodeURIComponent("TS="+o+"|MCMID="+e+"|MCORGID="+encodeURIComponent(t)),a=ic(r.match(Vt),4),u=a[1],c=a[2],s=a[3],d=function(e){return""===e?"?":"?"===e?"":"&"}(c);return""+u+c+d+"adobe_mc="+i+s}}({dateProvider:function(){return new Date},orgId:u,globalConfigOverrides:s});return function(e){var n,t=e.addEcidQueryToPayload,r=e.addQueryStringIdentityToPayload,o=e.ensureSingleIdentity,i=e.setLegacyEcid,a=e.handleResponseForIdSyncs,u=e.getEcidFromResponse,c=e.getIdentity,s=e.consent,d=e.appendIdentityToUrl,l=e.logger,f={};return{lifecycle:{onBeforeRequest:function(e){var n=e.request,i=e.onResponse,a=e.onRequestFailure;return t(n.getPayload()),r(n.getPayload()),o({request:n,onResponse:i,onRequestFailure:a})},onResponse:function(e){var t=e.response;return n||(n=u(t))&&i(n),f=m(f,t.getEdge()),a(t)}},commands:{getIdentity:{optionsValidator:Ct,run:function(e){return s.awaitConsent().then((function(){return n?void 0:c(e)})).then((function(){return{identity:{ECID:n},edge:f}}))}},appendIdentityToUrl:{optionsValidator:St,run:function(e){return s.withConsent().then((function(){return n?void 0:c(e)})).then((function(){return{url:d(n,e.url)}})).catch((function(n){return l.warn("Unable to append identity to url. "+n.message),e}))}}}}}({addEcidQueryToPayload:Pt,addQueryStringIdentityToPayload:h,ensureSingleIdentity:w,setLegacyEcid:d.setEcid,handleResponseForIdSyncs:I,getEcidFromResponse:At,getIdentity:f,consent:r,appendIdentityToUrl:C,logger:t,config:n})};zt.namespace="Identity",zt.configValidators=It;var Jt=function(e){var n=e.fireReferrerHideableImage,t=e.logger,r=e.cookieJar,o=e.isPageSsl?{sameSite:"none",secure:!0}:{};return function(e){return function(e){e.filter((function(e){return"cookie"===e.type})).forEach((function(e){var n=e.spec,t=n.name,i=n.value,a=n.domain,u=n.ttlDays;r.set(t,i||"",rc({domain:a||"",expires:u||10},o))}))}(e),function(e){var r=e.filter((function(e){return"url"===e.type}));return Promise.all(r.map((function(e){return n(e.spec).then((function(){t.info(function(e){return"URL destination succeeded: "+e.spec.url}(e))})).catch((function(){}))}))).then(he)}(e)}},Qt=function(e){var n=e.processDestinations;return function(e){var t,r,o=e.response;return(t={response:o},r=t.response.getPayloadsByType("activation:push"),n(r)).then((function(){return{destinations:{response:o}.response.getPayloadsByType("activation:pull")}}))}},Gt=function(e){var n=e.logger,t=e.fireReferrerHideableImage,r=b.withConverter({write:function(e){return encodeURIComponent(e)}}),o=k({logger:n,cookieJar:r}),i=Jt({fireReferrerHideableImage:t,logger:n,cookieJar:o,isPageSsl:"https:"===window.location.protocol});return{lifecycle:{onResponse:Qt({processDestinations:i})},commands:{}}};Gt.namespace="Audiences";var Xt="web",Wt="://",Yt=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,Kt=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,$t=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,Zt=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,er=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",n=e.length;n>0&&-1!=="/".indexOf(e.charAt(n-1));)n-=1;return e.substring(0,n)||"/"},nr=function(e){return""+e.surfaceType+Wt+e.authority+(e.path||"")+(e.fragment||"")},tr=function(e){var n=e(),t=n.host.toLowerCase(),r=n.pathname;return Xt+Wt+t+er(r)},rr=function(e,n,t){var r=function(e){return t.warn(e),null};if(!ve(e))return r("Invalid surface: "+e);var o,i,a,u,c=function(e,n){return B(e,"#")?tr(n)+e:e}(e,n),s=(u=c.match(Yt))?{surfaceType:(a=u[1],ve(a)?a.toLowerCase():""),authority:(i=u[2],ve(i)?i.toLowerCase():""),path:(o=u[3],ve(o)?er(o):"/"),fragment:u[4]}:null;return null===s?r("Invalid surface: "+e):l([Xt,"webapp"],s.surfaceType)?s.authority&&Kt.test(s.authority)?s.path&&!$t.test(s.path)?r("Invalid path "+s.path+" in surface: "+e):s.fragment&&!Zt.test(s.fragment)?r("Invalid fragment "+s.fragment+" in surface: "+e):s:r("Invalid authority "+s.authority+" in surface: "+e):r("Unsupported surface type "+s.surfaceType+" in surface: "+e)},or=function(e){return!!e&&0===e.indexOf(Xt+Wt)&&-1===e.indexOf("#")},ir="__view__",ar="https://ns.adobe.com/personalization/default-content-item",ur="https://ns.adobe.com/personalization/dom-action",cr="https://ns.adobe.com/personalization/html-content-item",sr="https://ns.adobe.com/personalization/json-content-item",dr="https://ns.adobe.com/personalization/ruleset-item",lr="https://ns.adobe.com/personalization/redirect-item",fr="https://ns.adobe.com/personalization/message/in-app",pr=function(e){return e.filter((function(n,t){return e.indexOf(n)===t}))},gr=function(e){var n=e.getPageLocation,t=e.renderDecisions,r=e.decisionScopes,o=e.personalization,i=e.event,a=e.isCacheInitialized,u=e.logger,c=i.getViewName();return{isRenderDecisions:function(){return t},isSendDisplayEvent:function(){return!!o.sendDisplayEvent},shouldIncludeRenderedPropositions:function(){return!!o.includeRenderedPropositions},getViewName:function(){return c},hasScopes:function(){return r.length>0||_(o.decisionScopes)},hasSurfaces:function(){return _(o.surfaces)},hasViewName:function(){return ve(c)},createQueryDetails:function(){var e=ac(r);_(o.decisionScopes)&&e.push.apply(e,ac(o.decisionScopes));var t=function(){var e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return rr(t,e,n)})).filter((function(e){return!v(e)})).map(nr)}(o.surfaces,n,u);this.shouldRequestDefaultPersonalization()&&(function(e){l(e,ir)||e.push(ir)}(e),function(e,n){var t=tr(n);l(e,t)||e.push(t)}(t,n));var i=[ar,cr,sr,lr,dr,fr,"https://ns.adobe.com/personalization/message/feed-item"];return l(e,ir)&&i.push(ur),{schemas:i,decisionScopes:pr(e),surfaces:pr(t)}},isCacheInitialized:function(){return a},shouldFetchData:function(){return this.hasScopes()||this.hasSurfaces()||this.shouldRequestDefaultPersonalization()},shouldUseCachedData:function(){return this.hasViewName()&&!this.shouldFetchData()},shouldRequestDefaultPersonalization:function(){return o.defaultPersonalizationEnabled||!this.isCacheInitialized()&&!1!==o.defaultPersonalizationEnabled}}},mr="decisioning.propositionDisplay",vr="decisioning.propositionInteract",hr="decisioning.propositionTrigger",yr="decisioning.propositionDismiss",wr={DISPLAY:"display",INTERACT:"interact",TRIGGER:"trigger",DISMISS:"dismiss"},br=nc(nc(nc(nc({},mr,wr.DISPLAY),vr,wr.INTERACT),hr,wr.TRIGGER),yr,wr.DISMISS);nc(nc(nc(nc({},wr.DISPLAY,mr),wr.INTERACT,vr),wr.TRIGGER,hr),wr.DISMISS,yr);var Er,Ir,Cr=function(e){return br[e]},Sr={propositions:[]},kr=function(e){var n=e.getPageLocation,t=e.logger,r=e.fetchDataHandler,o=e.viewChangeHandler,i=e.onClickHandler,a=e.isAuthoringModeEnabled,u=e.mergeQuery,c=e.viewCache,s=e.showContainers,d=e.applyPropositions,l=e.setTargetMigration,f=e.mergeDecisionsMeta,p=e.renderedPropositions,g=e.onDecisionHandler,m=e.handleConsentFlicker;return{lifecycle:{onComponentsRegistered:function(){m()},onDecision:g,onBeforeRequest:function(e){var n=e.request;return l(n),Promise.resolve()},onBeforeEvent:function(e){var i=e.event,d=e.renderDecisions,l=e.decisionScopes,g=void 0===l?[]:l,m=e.personalization,v=void 0===m?{}:m,h=e.onResponse,y=void 0===h?he:h,w=e.onRequestFailure,b=void 0===w?he:w;if(y((function(){return{propositions:[]}})),b((function(){return s()})),a())return t.warn("Rendering is disabled for authoring mode."),u(i,{enabled:!1}),Promise.resolve();var E=gr({getPageLocation:n,renderDecisions:d,decisionScopes:g,personalization:v,event:i,isCacheInitialized:c.isInitialized(),logger:t}),I=[];if(E.shouldIncludeRenderedPropositions()&&I.push(p.clear()),E.shouldFetchData()){var C=c.createCacheUpdate(E.getViewName());b((function(){return C.cancel()})),r({cacheUpdate:C,personalizationDetails:E,event:i,onResponse:y})}else E.shouldUseCachedData()&&I.push(o({personalizationDetails:E,event:i,onResponse:y,onRequestFailure:b}));return Promise.all(I).then((function(e){var n=te(e,(function(e){return e}));_(n)&&f(i,n,[wr.DISPLAY])}))},onClick:function(e){var n=e.event,t=e.clickedElement;i({event:n,clickedElement:t})}},commands:{applyPropositions:{optionsValidator:function(e){return function(e){var n=e.logger,t=e.options,r=bn({propositions:gn(bn({id:En().required(),scope:En().required(),scopeDetails:bn({decisionProvider:En().required()}).required(),items:gn(bn({id:En().required(),schema:En().required(),data:pn().required()})).nonEmpty().required()}).required()).nonEmpty().required(),metadata:bn(pn()),viewName:En()}).required();try{return r(t)}catch(e){return n.warn("Invalid options for applyPropositions. No propositions will be applied.",e),Sr}}({logger:t,options:e})},run:d}}}},Tr=function(e){return A("DIV",{},{innerHTML:e})},Dr={exports:{}},Pr=(Er||(Er=1,Dr.exports=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var n=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var n,t=String(e),r=t.length,o=-1,i="",a=t.charCodeAt(0);++o<r;)0!=(n=t.charCodeAt(o))?i+=n>=1&&n<=31||127==n||0==o&&n>=48&&n<=57||1==o&&n>=48&&n<=57&&45==a?"\\"+n.toString(16)+" ":0==o&&1==r&&45==n||!(n>=128||45==n||95==n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122)?"\\"+t.charAt(o):t.charAt(o):i+="";return i};return e.CSS||(e.CSS={}),e.CSS.escape=n,n}(void 0!==g?g:Dr.exports)),Dr.exports),Rr=$u(Pr),Or=/:eq\((\d+)\)/g,Ar=function(e){return-1===e.indexOf(":eq(")},Nr=/(#|\.)(-?\w+)/g,Mr=function(e,n,t){return""+n+Rr(t)},xr=function(e){for(var n=[],t=function(e){return e.split(Or).filter(ve)}(function(e){return e.replace(Nr,Mr)}(e.trim())),r=t.length,o=0;o<r;){var i=t[o],a=t[o+1];a?n.push({sel:i,eq:Number(a)}):n.push({sel:i}),o+=2}return n},qr=function(e){var n=document;if(Ar(e))return J(e,n);for(var t=xr(e),r=t.length,o=[],i=n,a=0;a<r;){var u=t[a],c=u.sel,s=u.eq,d=J(c,i),l=d.length;if(0===l)break;if(null!=s&&s>l-1)break;if(a<r-1)if(null==s)i=ic(d,1)[0];else i=d[s];a===r-1&&(o=null==s?d:[d[s]]),a+=1}return o},Lr=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).getElementById(e)},_r=function(e,n,t){e.setAttribute(n,t)},jr=function(e,n){return e.getAttribute(n)},Ur=function(e,n,t,r){var o;o=r?n+":"+t+" !"+r+";":n+":"+t+";",e.style.cssText+=";"+o},Fr=function(e){return e.parentNode},Br=function(e,n){if(e){var t=Fr(e);t&&t.insertBefore(n,function(e){return e.nextElementSibling}(e))}},Hr=function(e,n){if(e){var t=Fr(e);t&&t.insertBefore(n,e)}},Vr=function(e){var n=e.childNodes;return n?j(n):[]},zr=function(e){return e.firstElementChild},Jr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(void 0===Ir){var n=e.querySelector("[nonce]");Ir=n&&(n.nonce||n.getAttribute("nonce"))}return Ir},Qr="src",Gr=function(e){return A(N,{src:e})},Xr=function(e){J(N,e).forEach((function(e){var n=jr(e,Qr);n&&Gr(n)}))},Wr=function(e){return function(e,n){return e.tagName===n}(e,M)&&!jr(e,Qr)},Yr=function(e){var n=J(M,e),t=n.length,r=Jr();if(r)for(var o=0;o<t;o+=1){var i=n[o];Wr(i)&&(i.nonce=r)}},Kr=setTimeout;mc.prototype.catch=function(e){return this.then(null,e)},mc.prototype.then=function(e,n){var t=new this.constructor(gc);return vc(this,new bc(e,n,t)),t},mc.prototype.finally=function(e){var n=this.constructor;return this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){return n.reject(t)}))}))},mc.all=function(e){return new mc((function(n,t){if(!pc(e))return t(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);var o=r.length;function i(e,a){try{if(a&&("object"===cc(a)||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,(function(n){i(e,n)}),t)}r[e]=a,0==--o&&n(r)}catch(e){t(e)}}for(var a=0;a<r.length;a++)i(a,r[a])}))},mc.resolve=function(e){return e&&"object"===cc(e)&&e.constructor===mc?e:new mc((function(n){n(e)}))},mc.reject=function(e){return new mc((function(n,t){t(e)}))},mc.race=function(e){return new mc((function(n,t){if(!pc(e))return t(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)mc.resolve(e[r]).then(n,t)}))},mc._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){Kr(e,0)},mc._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var $r,Zr,eo,no,to=Zu(Object.freeze({__proto__:null,default:mc})),ro=function(){if(no)return eo;no=1;var e=Zr?$r:(Zr=1,$r="undefined"!=typeof window&&window.Promise||void 0!==g&&g.Promise||to.default||to);return eo=function(n){var t=document.createElement("script");t.src=n,t.async=!0;var r=function(n,t){return new e((function(e,r){t.onload=function(){e(t)},t.onerror=function(){r(new Error("Failed to load script "+n))}}))}(n,t);return document.getElementsByTagName("head")[0].appendChild(t),r},eo}(),oo=$u(ro),io=function(e,n){return!!e&&e.tagName===n},ao=function(e){return io(e,x)&&!jr(e,Qr)},uo=function(e){return io(e,x)&&jr(e,Qr)},co=function(e){for(var n=J(x,e),t=[],r=n.length,o=Jr(),i=rc({},o&&{nonce:o}),a=0;a<r;a+=1){var u=n[a];if(ao(u)){var c=u.textContent;c&&t.push(A(x,i,{textContent:c}))}}return t},so=function(e){for(var n=J(x,e),t=[],r=n.length,o=0;o<r;o+=1){var i=n[o];if(uo(i)){var a=jr(i,Qr);a&&t.push(a)}}return t},lo=function(e,n){n.forEach((function(n){e.appendChild(n),e.removeChild(n)}))},fo=function(e){return Promise.all(e.map(oo))},po=function(e,n,t){var r=Tr(n);Yr(r);var o=Vr(r),i=co(r),a=so(r);return Xr(r),o.forEach((function(n){O(e,n)})),t(e),lo(e,i),fo(a)},go=function(e,n,t){return function(e){Vr(e).forEach(K)}(e),po(e,n,t)},mo=function(e,n,t){var r=Tr(n);Yr(r);var o=Vr(r),i=co(r),a=so(r),u=o.length-1;for(Xr(r);u>=0;){var c=o[u];t(c);var s=zr(e);s?Hr(s,c):O(e,c),u-=1}return lo(e,i),fo(a)},vo="alloy-prehiding",ho={},yo=function(e){var n=ho[e];n&&(K(n),delete ho[e])},wo=function(e){if(e&&!Lr(vo)){var n=Jr(),t=rc({id:vo},n&&{nonce:n}),r=A(M,t,{textContent:e});O(document.head,r)}},bo=function(){var e=Lr(vo);e&&K(e)},Eo=function(e,n,t){t(e),e.textContent=n},Io=function(e,n,t){var r=Tr(n);Yr(r);var o=Vr(r),i=co(r),a=so(r);return Xr(r),o.forEach((function(n){t(n),Hr(e,n)})),lo(e,i),fo(a)},Co=function(e,n,t){return Io(e,n,t).then((function(){K(e)}))},So=function(e,n,t){var r=Tr(n);Yr(r);var o=Vr(r),i=co(r),a=so(r);Xr(r);var u=e;return o.forEach((function(e){t(e),Br(u,e),u=e})),lo(e,i),fo(a)},ko=["priority"],To=function(e,n,t){var r=n.priority,o=oc(n,ko);Object.keys(o).forEach((function(n){Ur(e,n,o[n],r)})),t(e)},Do=function(e,n,t){Object.keys(n).forEach((function(t){_r(e,t,n[t])})),t(e)},Po=function(e,n,t){e.tagName===N&&(Gr(n),t(e),function(e,n){e.removeAttribute(n)}(e,Qr),_r(e,Qr,n))},Ro=function(e,n,t){var r=n.from,o=n.to,i=function(e){var n=e.children;return n?j(n):[]}(e),a=i[r],u=i[o];a&&u&&(r<o?Br(u,a):Hr(u,a),t(u),t(a))},Oo=function(e){return function(n,t){var r=n.selector,o=n.prehidingSelector,i=n.content;return function(e){if(!ho[e]){var n=Jr(),t=rc({},n&&{nonce:n}),r=A(M,t,{textContent:e+" { visibility: hidden }"});O(document.head,r),ho[e]=r}}(o),Y(r,qr).then((function(n){return function(e,n,t,r){var o=e.map((function(e){return r(e,n,t)}));return Promise.all(o)}(n,i,t,e)})).then((function(){yo(o)}),(function(e){throw yo(o),e}))}},Ao=function(e){return(""+e).endsWith("px")?e:e+"px"},No=["priority"],Mo=function(e,n,t){var r=n.priority,o=oc(n,No);Object.keys(o).forEach((function(n){var t=o[n];"left"!==n&&"top"!==n||(t=Ao(t)),Ur(e,n,t,r)})),t(e)},xo=function(e,n,t){t(e)},qo=["priority"],Lo=function(e,n,t){var r=n.priority,o=oc(n,qo);Object.keys(o).forEach((function(n){var t=o[n];"width"!==n&&"height"!==n||(t=Ao(t)),Ur(e,n,t,r)})),t(e)},_o="customCode",jo="appendHtml",Uo="click",Fo="collectInteractions",Bo=function(e,n){if(Ar(e))return function(e,n){return n.matches?n.matches(e):n.msMatchesSelector(e)}(e,n);for(var t=qr(e),r=!1,o=0;o<t.length;o+=1)if(t[o]===n){r=!0;break}return r},Ho="view",Vo=["trackingLabel","scopeType"],zo=function(e){return e.map((function(e){return e.trackingLabel,e.scopeType,oc(e,Vo)}))},Jo=function(e){return e.filter((function(n,t){var r=JSON.stringify(n);return t===e.findIndex((function(e){return JSON.stringify(e)===r}))}))},Qo=function(e,n,t){for(var r=document.documentElement,o=e,i=0;o&&o!==r;){if(Bo(n,o)){var a=t(n),u={metas:a},c=a.find((function(e){return e.trackingLabel}));c&&(u.label=c.trackingLabel,u.weight=i);var s=a.find((function(e){return e.scopeType===Ho}));return s&&(u.viewName=s.scope,u.weight=i),u}o=o.parentNode,i+=1}return{metas:null}},Go=function(e,n,t){for(var r,o=[],i="",a=Number.MAX_SAFE_INTEGER,u=Number.MAX_SAFE_INTEGER,c=0;c<n.length;c+=1){var s=Qo(e,n[c],t),d=s.metas,l=s.label,f=s.weight,p=s.viewName;d&&(l&&f<=a&&(i=l,a=f),p&&f<=u&&(r=p,u=f),o.push.apply(o,ac(zo(d))))}return{decisionsMeta:Jo(o),propositionActionLabel:i,propositionActionToken:void 0,viewName:r}},Xo=function(){return-1!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).location.href.indexOf("adobe_authoring_enabled")},Wo=function(e,n,t,r){if(0!==n.length){var o={};t.forEach((function(e){o[e]=1}));var i={_experience:{decisioning:{propositions:n,propositionEventType:o}}};r&&(i._experience.decisioning.propositionAction=r),e.mergeXdm(i)}},Yo=function(e,n){e.mergeQuery({personalization:rc({},n)})},Ko=function(){var e={};return{storeClickMeta:function(n){var t=n.selector,r=n.meta,o=r.id,i=r.scope,a=r.scopeDetails,u=r.trackingLabel,c=r.scopeType;e[t]||(e[t]={}),e[t][o]={scope:i,scopeDetails:a,trackingLabel:u,scopeType:c}},getClickSelectors:function(){return Object.keys(e)},getClickMetas:function(n){return e[n]?function(e){return Object.keys(e).map((function(n){return rc({id:n},e[n])}))}(e[n]):{}}}},$o=function(e,n){return e===sr&&n===Fo},Zo=nc(nc(nc(nc({},ur,(function(){return!0})),cr,(function(){return!0})),sr,$o),fr,(function(){return!0})),ei=function(e){var n=e.processPropositions,t=e.createProposition,r=e.renderedPropositions,o=e.viewCache,i=function(e){var n=e.items,t=e.metadataForScope,r=void 0===t?{}:t,o=r.actionType,i=r.selector;return n.filter((function(e){return function(e,n){return"function"==typeof Zo[e]&&Zo[e](e,n)}(e.schema,o)})).map((function(e){var n=e.schema;return n===cr||$o(n,o)?ee(r)?void 0:rc(rc({},e),{},{schema:$o(n,o)?ur:n,data:rc(rc({},e.data),{},{selector:i,type:o})}):rc({},e)})).filter((function(e){return e}))},a=function(e){return!(e.scope===ir&&e.renderAttempted)};return function(e){var u=e.propositions,c=void 0===u?[]:u,s=e.metadata,d=void 0===s?{}:s,l=e.viewName,f=D();r.concat(f.promise);var p=function(e){var n=e.propositions,t=e.metadata;return n.filter(a).map((function(e){return _(e.items)?{id:e.id,scope:e.scope,scopeDetails:e.scopeDetails,items:i({items:e.items,metadataForScope:t[e.scope]})}:e})).filter((function(e){return _(e.items)}))}({propositions:c,metadata:d}).map((function(e){return t(e)}));return Promise.resolve().then((function(){return l?o.getView(l):[]})).then((function(e){var t=n([].concat(ac(p),ac(e))),r=t.render,o=t.returnedPropositions;return r().then(f.resolve),{propositions:o}}))}},ni=function(e){var n=e.selector;return e.type!==_o||"BODY > *:eq(0)"!==n?e:m({},e,{selector:"BODY"})},ti=function(e){return!me(e)||!e.trim()},ri=function(e){var n=m({},e),t=n.content,r=n.selector;if(ti(t))return n;if(null==r)return n;var o=qr(r);return io(o[0],"HEAD")?(n.type=jo,n.content=function(e){var n=Tr(e);return J("SCRIPT,LINK,STYLE",n).map((function(e){return e.outerHTML})).join("")}(t),n):n},oi=function(e){var n=e.preprocess,t=e.isPageWideSurface;return function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e.id,i=e.scope,a=e.scopeDetails,u=e.items,c=void 0===u?[]:u,s=(a||{}).characteristics,d=(void 0===s?{}:s).scopeType;return{getScope:function(){return i||i},getScopeType:function(){return i===ir||t(i)?"page":d===Ho?Ho:"proposition"},getItems:function(){var e=this;return c.map((function(t){return function(e,t){var r=e.id,o=e.schema,i=e.data,a=e.characteristics,u=(void 0===a?{}:a).trackingLabel,c=i?i.type:void 0,s=n(i);return{getId:function(){return r},getSchema:function(){return o},getSchemaType:function(){return c},getData:function(){return s},getProposition:function(){return t},getTrackingLabel:function(){return u},getOriginalItem:function(){return e},toString:function(){return JSON.stringify(e)},toJSON:function(){return e}}}(t,e)}))},getNotification:function(){return{id:o,scope:i,scopeDetails:a}},getId:function(){return o},toJSON:function(){return e},addToReturnValues:function(n,t,o,i){r&&(n.push(rc(rc({},e),{},{items:o.map((function(e){return e.getOriginalItem()})),renderAttempted:i})),i||t.push(rc(rc({},e),{},{items:o.map((function(e){return e.getOriginalItem()}))})))}}}},ii=function(){return{setRenderAttempted:!0,includeInNotification:!0}},ai="always",ui="never",ci="decoratedElementsOnly",si=[ai,ui,ci],di="data-aep-interact-id",li="data-aep-click-label",fi=0,pi=function(e,n,t,r,o,i,a,u){var c=a.scopeDetails;return function(e,n){return!!e&&!!e[n]&&l([ai,ci],e[n])}(e,(void 0===c?{}:c).decisionProvider)||n===Uo?function(e){if(e.tagName){var n,c=(n=jr(e,di))?parseInt(n,10):++fi;u(t,r,i,a,c),_r(e,di,c),o&&!jr(e,li)&&_r(e,li,o)}}:he},gi=function(e){var n=e.schemaProcessors,t=e.logger,r=function(e,n){return function(){return Promise.resolve().then(e).then((function(){return t.enabled&&t.info("Action "+n.toString()+" executed."),!0})).catch((function(e){if(t.enabled){var r=e.message,o=e.stack,i="Failed to execute action "+n.toString()+". "+r+" "+o;t.warn(i)}return!1}))}},o=function(e){var t=n[e.getSchema()];return t?t(e):{}},i=function(e){for(var n,t,i,a,u=e.renderers,c=e.returnedPropositions,s=e.returnedDecisions,d=e.items,l=e.proposition,f=ac(u),p=ac(c),g=ac(s),m=[],v=[],h=[],y=!1,w=!1,b=0;d.length>b;){a=d[b];var E=o(a);if(n=E.render,t=E.setRenderAttempted,i=E.includeInNotification,w=E.onlyRenderThis){p=[],g=[],t?(m=[a],v=[]):(m=[],v=[a]),f=[],h=[n],y=i;break}n&&h.push(r(n,a)),i&&(y=!0),t?m.push(a):v.push(a),b+=1}if(h.length>0){var I=y?l.getNotification():void 0;f.push((function(){return function(e,n){return Promise.all(e.map((function(e){return e()}))).then((function(e){if(e.includes(!0))return n}))}(h,I)}))}else y&&f.push((function(){return Promise.resolve(l.getNotification())}));return m.length>0&&l.addToReturnValues(p,g,m,!0),v.length>0&&l.addToReturnValues(p,g,v,!1),{renderers:f,returnedPropositions:p,returnedDecisions:g,onlyRenderThis:w}};return function(e){for(var n,t,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[],u=[],c=[],s=0;e.length>s;){r=(t=e[s]).getItems();var d=i({renderers:a,returnedPropositions:u,returnedDecisions:c,items:r,proposition:t});if(a=d.renderers,u=d.returnedPropositions,c=d.returnedDecisions,n=d.onlyRenderThis)break;s+=1}n&&e.forEach((function(e,n){n!==s&&e.addToReturnValues(u,c,e.getItems(),!1)})),o.forEach((function(e){e.addToReturnValues(u,c,e.getItems(),!1)}));return{returnedPropositions:u,returnedDecisions:c,render:function(){return Promise.all(a.map((function(e){return e()}))).then((function(e){return e.filter((function(e){return e}))}))}}}},mi="text/html",vi=["content","contentType"],hi=["mobileParameters","webParameters","html"],yi=function(e){var n=e.modules,t=e.logger;return function(e){var r=e.getData(),o=rc({},e.getProposition().getNotification());if(!r)return t.warn("Invalid in-app message data: undefined.",r),{};var i=r.type,a=void 0===i?"defaultContent":i;return n[a]?function(e,n){for(var t=0;t<vi.length;t+=1){var r=vi[t];if(!Object.prototype.hasOwnProperty.call(e,r))return n.warn("Invalid in-app message data: missing property '"+r+"'.",e),!1}var o=e.content;if("application/json"===e.contentType)for(var i=0;i<hi.length;i+=1){var a=hi[i];if(!Object.prototype.hasOwnProperty.call(o,a))return n.warn("Invalid in-app message data.content: missing property '"+a+"'.",e),!1}return!0}(r,t)?o?{render:function(){return n[a](rc(rc({},r),{},{meta:o}))},setRenderAttempted:!0,includeInNotification:!0}:(t.warn("Invalid in-app message meta: undefined.",o),{}):{}:(t.warn("Invalid in-app message data: unknown type.",r),{})}},wi=function(e){var n=J("#"+e,document);n&&n.length>0&&K(n[0])},bi=function(e){return function(n){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.location.href=n:e.location.replace(n),new Promise((function(){}))}},Ei="alloy-messaging-container",Ii="alloy-overlay-container",Ci="alloy-content-iframe",Si=function(){return[Ei,Ii].forEach(wi)},ki=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bi(window);return function(t){t.preventDefault(),t.stopImmediatePropagation();var r=t.target,o="a"===r.tagName.toLowerCase()?r:r.closest("a");if(o){var i=function(e){var n={};if(!e||"a"!==e.tagName.toLowerCase())return n;var t=e.href;if(!t||!B(t,"adbinapp://"))return n;var r,o,i=t.split("?"),a=i[0].split("://")[1],u=e.innerText,c=e.getAttribute("data-uuid")||"";if(_(i)){var s=Se.parse(i[1]);r=s.interaction||"",o=decodeURIComponent(s.link||"")}return{action:a,interaction:r,link:o,label:u,uuid:c}}(o),a=i.action,u=i.interaction,c=i.link,s=i.label,d=i.uuid;e(a,{label:s,id:u,uuid:d,link:c}),"dismiss"===a&&Si(),ve(c)&&c.length>0&&n(c,!0)}}},Ti=function(e){var n=e.verticalAlign,t=e.width,r=e.horizontalAlign,o=e.backdropColor,i=e.height,a=e.cornerRadius,u=e.horizontalInset,c=e.verticalInset,s=e.uiTakeover,d={width:t?t+"%":"100%",backgroundColor:o||"rgba(0, 0, 0, 0.5)",borderRadius:a?a+"px":"0px",border:"none",position:void 0!==s&&s?"fixed":"relative",overflow:"hidden"};return"left"===r?d.left=u?u+"%":"0":"right"===r?d.right=u?u+"%":"0":"center"===r&&(d.left="50%",d.transform="translateX(-50%)"),"top"===n?d.top=c?c+"%":"0":"bottom"===n?(d.position="fixed",d.bottom=c?c+"%":"0"):"center"===n&&(d.top="50%",d.transform=("center"===r?d.transform+" ":"")+"translateY(-50%)",d.display="flex",d.alignItems="center",d.justifyContent="center"),d.height=i?i+"vh":"100%",d},Di=function(e){return{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"transparent",opacity:e.backdropOpacity||.5,backgroundColor:e.backdropColor||"#FFFFFF"}},Pi=["enabled","parentElement","insertionMethod"],Ri=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;Si();var t=e.content,r=e.contentType,o=e.mobileParameters,i=e.webParameters;if(r===mi){var a=A("div",{id:Ei}),u=function(e,n){var t=(new DOMParser).parseFromString(e,mi),r=t.querySelector("script");r&&r.setAttribute("nonce",Jr());var o=A("iframe",{src:URL.createObjectURL(new Blob([t.documentElement.outerHTML],{type:"text/html"})),id:Ci});return o.addEventListener("load",(function(){(0,(o.contentDocument||o.contentWindow.document).addEventListener)("click",n)})),o}(t,ki(n)),c=A("div",{id:Ii});(function(e){if(!e)return!1;var n=Object.keys(e);if(!l(n,Ei))return!1;if(!l(n,Ii))return!1;for(var t=kn(e),r=0;r<t.length;r+=1){if(!bn(t[r],"style"))return!1;if(!bn(t[r],"params"))return!1;for(var o=0;o<Pi.length;o+=1)if(!bn(t[r].params,Pi[o]))return!1}return!0})(i)||(i=function(e){if(e){var n=e.uiTakeover,t=void 0!==n&&n;return nc(nc(nc({},Ci,{style:{border:"none",width:"100%",height:"100%"},params:{enabled:!0,parentElement:"#alloy-messaging-container",insertionMethod:"appendChild"}}),Ei,{style:Ti(e),params:{enabled:!0,parentElement:"body",insertionMethod:"appendChild"}}),Ii,{style:Di(e),params:{enabled:!0===t,parentElement:"body",insertionMethod:"appendChild"}})}}(o)),i&&function(e,n,t,r){[{id:Ii,element:r},{id:Ei,element:t},{id:Ci,element:e}].forEach((function(e){var t=e.id,r=e.element,o=n[t],i=o.style,a=void 0===i?{}:i,u=o.params,c=void 0===u?{}:u;m(r.style,a);var s=c.parentElement,d=void 0===s?"body":s,l=c.insertionMethod,f=void 0===l?"appendChild":l,p=c.enabled,g=void 0===p||p,v=document.querySelector(d);g&&v&&"function"==typeof v[f]&&v[f](r)}))}(u,i,a,c)}},Oi=function(e){return{defaultContent:function(n){return function(e,n){return new Promise((function(t){var r=e.meta;Ri(e,(function(e,t){var o={};o[wr.INTERACT]=1,-1!==Object.values(wr).indexOf(e)&&(o[e]=1),n({decisionsMeta:[r],propositionAction:t,eventType:vr,propositionEventTypes:Object.keys(o)})})),t({meta:r})}))}(n,e)}}},Ai=function(e){var n=e.find((function(e){return e.scopeType===Ho}));return n?n.scope:void 0},Ni=function(e,n,t){var r=function(e){for(var n,t,r=document.documentElement,o=e,i=new Set;o&&o!==r;){var a=jr(o,di);a&&i.add(a),n=n||jr(o,li),t=t||jr(o,"data-aep-click-token"),o=o.parentNode}return{interactIds:ac(i),clickLabel:n,clickToken:t}}(e),o=r.interactIds,i=r.clickLabel,a=void 0===i?"":i,u=r.clickToken,c=function(e,n,t){return function(r){var o=r.scopeDetails,i=(void 0===o?{}:o).decisionProvider;return e[i]===ai||e[i]===ci&&(n||t)}}(t,a,u);if(0===o.length)return{};var s=n(o).filter(c);return{decisionsMeta:zo(s),propositionActionLabel:a,propositionActionToken:u,viewName:Ai(s)}},Mi="AJO",xi=function(e){var n,t,r,o,i=e.config,a=e.logger,u=e.eventManager,c=e.consent,s=i.targetMigrationEnabled,d=i.prehidingStyle,l=i.autoCollectPropositionInteractions,f=function(e){var n=e.eventManager,t=e.mergeDecisionsMeta;return function(e){var r=e.decisionsMeta,o=void 0===r?[]:r,i=e.propositionAction,a=e.documentMayUnload,u=void 0!==a&&a,c=e.eventType,s=void 0===c?mr:c,d=e.propositionEventTypes,l=void 0===d?[Cr(s)]:d,f=e.viewName,p=n.createEvent(),g={eventType:s};return f&&(g.web={webPageDetails:{viewName:f}}),_(o)&&t(p,o,l,i),p.mergeXdm(g),u&&p.documentMayUnload(),n.sendEvent(p)}}({eventManager:u,mergeDecisionsMeta:Wo}),p=(n={},t={},{storeInteractionMeta:function(e,r,o,i,a){a=parseInt(a,10),n[a]||(n[a]={},t[a]={}),t[a][e]||(t[a][e]=new Set),t[a][e].add(r),n[a][e]=rc(rc({},i),{},{scopeType:o})},getInteractionMetas:function(e){return Array.isArray(e)&&0!==e.length?Object.values(e.map((function(e){return parseInt(e,10)})).reduce((function(e,r){return Object.keys(n[r]||{}).forEach((function(o){e[o]||(e[o]={proposition:n[r][o],items:new Set}),e[o].items=new Set([].concat(ac(e[o].items),ac(t[r][o])))})),e}),{})).map((function(e){var n=e.proposition,t=e.items;return rc(rc({},n),{},{items:Array.from(t).map((function(e){return{id:e}}))})})):[]}}),g=p.storeInteractionMeta,v=p.getInteractionMetas,h=Ko(),y=h.storeClickMeta,w=h.getClickSelectors,b=h.getClickMetas,E=function(e){var n=e.window;return function(){return n.location}}({window:window}),I=function(){var e;return nc(nc(nc(nc(nc(nc(nc(nc(nc(nc(e={},"setHtml",Oo(go)),_o,Oo(mo)),"setText",Oo(Eo)),"setAttribute",Oo(Do)),"setImageSource",Oo(Po)),"setStyle",Oo(To)),"move",Oo(Mo)),"resize",Oo(Lo)),"rearrange",Oo(Ro)),"remove",Oo(K)),nc(nc(nc(nc(nc(nc(e,"insertAfter",Oo(So)),"insertBefore",Oo(Io)),"replaceHtml",Oo(Co)),"prependHtml",Oo(mo)),jo,Oo(po)),Fo,Oo(xo))}(),C=(r=[ri,ni],function(e){return e?r.reduce((function(e,n){return m(e,n(e))}),e):e}),S=oi({preprocess:C,isPageWideSurface:or}),k=function(e){var n=e.createProposition,t=!1,r=Promise.resolve({}),o=function(e,t){var r=e[t.toLowerCase()];return r&&r.length>0?r:[n({scope:t,scopeDetails:{characteristics:{scopeType:Ho}},items:[{schema:ar}]},!1)]};return{createCacheUpdate:function(e){var n=D();return t=!0,r=r.then((function(e){return n.promise.then((function(n){return m({},e,n)})).catch((function(){return e}))})),{update:function(t){var r=t.filter((function(e){return e.getScope()})),i=ce(r,(function(e){return e.getScope().toLowerCase()}));return n.resolve(i),e?o(i,e):[]},cancel:function(){n.reject()}}},getView:function(e){return r.then((function(n){return o(n,e)}))},isInitialized:function(){return t}}}({createProposition:S}),T=bi(window),P=nc(nc(nc(nc(nc({},ar,ii),ur,function(e){var n=e.modules,t=e.logger,r=e.storeInteractionMeta,o=e.storeClickMeta,i=e.autoCollectPropositionInteractions;return function(e){var a=e.getData()||{},u=a.type,c=a.selector;if(!u)return t.warn("Invalid DOM action data: missing type.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};if(u===Uo)return c?(o({selector:c,meta:rc(rc({},e.getProposition().getNotification()),{},{trackingLabel:e.getTrackingLabel(),scopeType:e.getProposition().getScopeType()})}),{setRenderAttempted:!0,includeInNotification:!1}):(t.warn("Invalid DOM action data: missing selector.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1});if(!n[u])return t.warn("Invalid DOM action data: unknown type.",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};var s=pi(i,u,e.getProposition().getId(),e.getId(),e.getTrackingLabel(),e.getProposition().getScopeType(),e.getProposition().getNotification(),r);return{render:function(){return n[u](e.getData(),s)},setRenderAttempted:!0,includeInNotification:!0}}}({modules:I,logger:a,storeInteractionMeta:g,storeClickMeta:y,autoCollectPropositionInteractions:l})),cr,function(e){var n=e.modules,t=e.logger,r=e.storeInteractionMeta,o=e.autoCollectPropositionInteractions;return function(e){var i=e.getData()||{},a=i.type;if(!i.selector||!a)return{setRenderAttempted:!1,includeInNotification:!1};if(!n[a])return t.warn("Invalid HTML content data",e.getData()),{setRenderAttempted:!1,includeInNotification:!1};var u=pi(o,a,e.getProposition().getId(),e.getId(),e.getTrackingLabel(),e.getProposition().getScopeType(),e.getProposition().getNotification(),r);return{render:function(){return n[a](e.getData(),u)},setRenderAttempted:!0,includeInNotification:!0}}}({modules:I,logger:a,storeInteractionMeta:g,autoCollectPropositionInteractions:l})),lr,function(e){var n=e.logger,t=e.executeRedirect,r=e.collect;return function(e){var o=(e.getData()||{}).content;return o?{render:function(){return r({decisionsMeta:[e.getProposition().getNotification()],documentMayUnload:!0}).then((function(){return t(o)}))},setRenderAttempted:!0,onlyRenderThis:!0}:(n.warn("Invalid Redirect data",e.getData()),{})}}({logger:a,executeRedirect:T,collect:f})),fr,yi({modules:Oi(f),logger:a})),R=gi({schemaProcessors:P,logger:a}),O=(o=Promise.resolve([]),{concat:function(e){o=o.then((function(n){return e.then((function(e){return n.concat(e)})).catch((function(){return n}))}))},clear:function(){var e=o;return o=Promise.resolve([]),e}}),A=function(e,n){return function(t,r,o){if(!t)return function(){};if(!r){var i=D();return n.concat(i.promise),i.resolve}return function(n){n.length>0&&e({decisionsMeta:n,viewName:o})}}}(f,O),N=function(e){var n=e.prehidingStyle,t=e.showContainers,r=e.hideContainers,o=e.mergeQuery,i=e.processPropositions,a=e.createProposition,u=e.notificationHandler,c=e.consent;return function(e){var s=e.cacheUpdate,d=e.personalizationDetails,l=e.event,f=e.onResponse,p=c.current(),g=p.state,m=p.wasSet;"out"===g&&m||(d.isRenderDecisions()?r(n):t()),o(l,d.createQueryDetails());var v=u(d.isRenderDecisions(),d.isSendDisplayEvent(),d.getViewName());f((function(e){var n,r,o,u=e.response.getPayloadsByType("personalization:decisions").map((function(e){return a(e)})),c=ce(u,(function(e){return e.getScopeType()})),l=c.page,f=void 0===l?[]:l,p=c.view,g=void 0===p?[]:p,m=c.proposition,h=void 0===m?[]:m,y=s.update(g);if(d.isRenderDecisions()){var w=i([].concat(ac(f),ac(y)),h);n=w.render,r=w.returnedPropositions,o=w.returnedDecisions,n().then(v),t()}else{var b=i([],[].concat(ac(f),ac(y),ac(h)));r=b.returnedPropositions,o=b.returnedDecisions}return{propositions:r,decisions:o}}))}}({prehidingStyle:d,showContainers:bo,hideContainers:wo,mergeQuery:Yo,processPropositions:R,createProposition:S,notificationHandler:A,consent:c}),M=function(e){var n=e.mergeDecisionsMeta,t=e.collectInteractions,r=e.collectClicks,o=e.getInteractionMetas,i=e.getClickMetas,a=e.getClickSelectors,u=e.autoCollectPropositionInteractions;return function(e){var c,s,d,l=e.event,f=e.clickedElement,p=[];if([t(f,o,u),r(f,a(),i)].forEach((function(e){var n=e.decisionsMeta,t=e.propositionActionLabel,r=e.propositionActionToken,o=e.viewName;Array.prototype.push.apply(p,n),!c&&t&&(c=t),!s&&r&&(s=r),!d&&o&&(d=o)})),_(p)){var g={eventType:vr};d&&(g.web={webPageDetails:{viewName:d}}),l.mergeXdm(g),n(l,p,[wr.INTERACT],function(e,n){if(n||e){var t={};return e&&(t.label=e),n&&(t.tokens=[n]),t}}(c,s))}}}({mergeDecisionsMeta:Wo,collectInteractions:Ni,collectClicks:Go,getInteractionMetas:v,getClickMetas:b,getClickSelectors:w,autoCollectPropositionInteractions:l}),x=function(e){var n=e.processPropositions,t=e.viewCache;return function(e){var r,o,i=e.personalizationDetails,a=e.onResponse,u=i.getViewName();return a((function(){return{propositions:r,decisions:o}})),t.getView(u).then((function(e){var t;if(i.isRenderDecisions()){var a=n(e);return t=a.render,r=a.returnedPropositions,o=a.returnedDecisions,t()}var u=n([],e);return r=u.returnedPropositions,o=u.returnedDecisions,[]}))}}({processPropositions:R,viewCache:k}),q=ei({processPropositions:R,createProposition:S,renderedPropositions:O,viewCache:k}),L=function(e){return e.targetMigrationEnabled?function(e){e.getPayload().mergeMeta({target:{migration:!0}})}:he}({targetMigrationEnabled:s}),j=function(e){var n=e.processPropositions,t=e.createProposition,r=e.notificationHandler;return function(e){var o=e.renderDecisions,i=e.propositions,a=e.event,u=e.personalization,c=void 0===u?{}:u;if(!o)return Promise.resolve();var s=c.sendDisplayEvent,d=void 0===s||s,l=a?a.getViewName():void 0,f=i.map((function(e){return t(e,!0)})),p=n(f),g=p.render,m=p.returnedPropositions,v=r(o,d,l);return g().then(v),Promise.resolve({propositions:m})}}({processPropositions:R,createProposition:S,notificationHandler:A}),U=function(e){var n=e.showContainers,t=e.consent;return function(){var e=t.current(),r=e.state,o=e.wasSet;r===Mn&&o?n():t.awaitConsent().catch(n)}}({showContainers:bo,consent:c});return kr({getPageLocation:E,logger:a,fetchDataHandler:N,viewChangeHandler:x,onClickHandler:M,isAuthoringModeEnabled:Xo,mergeQuery:Yo,viewCache:k,showContainers:bo,applyPropositions:q,setTargetMigration:L,mergeDecisionsMeta:Wo,renderedPropositions:O,onDecisionHandler:j,handleConsentFlicker:U})};xi.namespace="Personalization";var qi=si.map((function(e){return hn(e)}));xi.configValidators=bn({prehidingStyle:En().nonEmpty(),targetMigrationEnabled:mn().default(!1),autoCollectPropositionInteractions:bn(nc(nc({},Mi,fn(qi).default(ai)),"TGT",fn(qi).default(ui))).default(nc(nc({},Mi,ai),"TGT",ui)).noUnknownFields()});var Li,_i=function(e){return function(n){var t=e().toISOString();I(n,{timestamp:t})}},ji="2.21.1",Ui=[["architecture","string"],["bitness","string"],["model","string"],["platformVersion","string"],["wow64","boolean"]],Fi=function(e){return function(n){var t={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};I(n,{web:t})}}(window),Bi=function(e){return function(n){var t=e.screen,r=t.width,o=t.height,i={},a=Pe(o);a>=0&&(i.screenHeight=a);var u=Pe(r);u>=0&&(i.screenWidth=u);var c=function(e){var n=e.screen.orientation;if(null==n||null==n.type)return null;var t=n.type.split("-");return 0===t.length||"portrait"!==t[0]&&"landscape"!==t[0]?null:t[0]}(e)||function(e){if(L(e.matchMedia)){if(e.matchMedia("(orientation: portrait)").matches)return"portrait";if(e.matchMedia("(orientation: landscape)").matches)return"landscape"}return null}(e);c&&(i.screenOrientation=c),Object.keys(i).length>0&&I(n,{device:i})}}(window),Hi=function(e){return function(n){var t=e.document.documentElement,r=void 0===t?{}:t,o=r.clientWidth,i=r.clientHeight,a={type:"browser"},u=Pe(o);u>=0&&(a.browserDetails={viewportWidth:u});var c=Pe(i);c>=0&&(a.browserDetails=a.browserDetails||{},a.browserDetails.viewportHeight=c),I(n,{environment:a})}}(window),Vi=(Li=function(){return new Date},function(e){var n=Li(),t={},r=Pe(n.getTimezoneOffset());void 0!==r&&(t.localTimezoneOffset=r),(void 0===r||Math.abs(r)<6e3)&&(t.localTime=function(e){var n=e.getFullYear(),t=ye(e.getMonth()+1,2,"0"),r=ye(e.getDate(),2,"0"),o=ye(e.getHours(),2,"0"),i=ye(e.getMinutes(),2,"0"),a=ye(e.getSeconds(),2,"0"),u=ye(e.getMilliseconds(),3,"0"),c=Pe(e.getTimezoneOffset(),0);return n+"-"+t+"-"+r+"T"+o+":"+i+":"+a+"."+u+(c>0?"-":"+")+ye(Math.floor(Math.abs(c)/60),2,"0")+":"+ye(Math.abs(c)%60,2,"0")}(n)),I(e,{placeContext:t})}),zi=_i((function(){return new Date})),Ji={web:Fi,device:Bi,environment:Hi,placeContext:Vi},Qi={highEntropyUserAgentHints:function(e){return function(e){return void 0!==e.userAgentData}(e)?function(n,t){try{return e.userAgentData.getHighEntropyValues(Ui.map((function(e){return e[0]}))).then((function(e){var t={};Ui.forEach((function(n){var r=ic(n,2),o=r[0],i=r[1];Object.prototype.hasOwnProperty.call(e,o)&&cc(e[o])===i&&(t[o]=e[o])})),I(n,{environment:{browserDetails:{userAgentClientHints:t}}})}))}catch(e){return t.warn("Unable to collect user-agent client hints. "+e.message),he}}:he}(navigator)},Gi=rc(rc({},Ji),Qi),Xi=[zi,function(e){I(e,{implementationDetails:{name:"https://ns.adobe.com/experience/alloy",version:ji,environment:"browser"}})}],Wi=function(e){return function(e,n,t,r){var o=e.context,i=te(o,(function(e,r){return t[e]?[t[e]]:(n.warn("Invalid context["+r+"]: '"+e+"' is not available."),[])})).concat(r);return{namespace:"Context",lifecycle:{onBeforeEvent:function(e){var t=e.event,r={};return Promise.all(i.map((function(e){return Promise.resolve(e(r,n))}))).then((function(){return t.mergeXdm(r)}))}}}}(e.config,e.logger,Gi,Xi)};Wi.namespace="Context",Wi.configValidators=bn({context:gn(En()).default(Object.keys(Ji))});var Yi=function(e){return Array.isArray(e)?e.map((function(e){return Yi(e)})):"object"===cc(e)&&null!==e?Object.keys(e).sort().reduce((function(n,t){return n[t]=Yi(e[t]),n}),{}):e},Ki=["standard","version"],$i=function(e){return e.standard+"."+e.version},Zi=function(e){var n=e.storage;return{clear:function(){n.clear()},lookup:function(e){var t={},r=function(e){var n=$i(e);e.standard,e.version;var r,o=oc(e,Ki);return t[n]||(t[n]=(r=o,T(JSON.stringify(Yi(r)))).toString()),t[n]};return{isNew:function(){return e.some((function(e){var t=$i(e),o=n.getItem(t);return null===o||o!==r(e)}))},save:function(){e.forEach((function(e){var t=$i(e);n.setItem(t,r(e))}))}}}}},ea=function(){var e={},n=qt({content:e,addIdentity:function(n,t){e.identityMap=e.identityMap||{},e.identityMap[n]=e.identityMap[n]||[],e.identityMap[n].push(t)},hasIdentity:function(n){return void 0!==(e.identityMap&&e.identityMap[n])}});return n.setConsent=function(n){e.consent=n},n},na=function(e){var n=e.payload,t=e.datastreamIdOverride;return Mt({payload:n,datastreamIdOverride:t,getAction:function(){return"privacy/set-consent"},getUseSendBeacon:function(){return!1}})},ta=function(e){return e.split(";").reduce((function(e,n){var t=ic(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{})},ra=bn({consent:gn(pn()).required().nonEmpty(),identityMap:Cn,edgeConfigOverrides:Sn}).noUnknownFields().required(),oa=function(e){var n,t,r=e.config,o=e.consent,i=e.sendEdgeNetworkRequest,a=e.createNamespacedStorage,u=r.orgId,c=r.defaultConsent,s=function(e){var n=e.parseConsentCookie,t=e.orgId,r=e.cookieJar,o=ue(t,"consent");return{read:function(){var e=r.get(o);return e?n(e):{}},clear:function(){r.remove(o)}}}({parseConsentCookie:ta,orgId:u,cookieJar:b}),d=(n=0,t=Promise.resolve(),{addTask:function(e){n+=1;var r=function(){return e().finally((function(){n-=1}))};return t=t.then(r,r)},get length(){return n}}),l=function(e){var n=e.createConsentRequestPayload,t=e.createConsentRequest,r=e.sendEdgeNetworkRequest,o=e.edgeConfigOverrides;return function(e){var i=e.consentOptions,a=e.identityMap,u=e.edgeConfigOverrides,c=Ut({payload:n(),globalConfigOverrides:o,localConfigOverrides:u});c.payload.setConsent(i),h(a)&&Object.keys(a).forEach((function(e){a[e].forEach((function(n){c.payload.addIdentity(e,n)}))}));var s=t(c);return r({request:s}).then((function(){}))}}({createConsentRequestPayload:ea,createConsentRequest:na,sendEdgeNetworkRequest:i,edgeConfigOverrides:r.edgeConfigOverrides}),f=a(ae(u)+".consentHashes."),p=Zi({storage:f.persistent}),g=se({orgId:u});return function(e){var n=e.storedConsent,t=e.taskQueue,r=e.defaultConsent,o=e.consent,i=e.sendSetConsentRequest,a=e.validateSetConsentOptions,u=e.consentHashStore,c=e.doesIdentityCookieExist,s=nc({},qn,r),d=n.read(),l=c(),f=void 0!==d[qn];l&&f||u.clear(),l||(n.clear(),d={}),o.initializeConsent(s,d);var p=function(){if(0===t.length){var e=n.read();void 0!==e[qn]&&o.setConsent(e)}};return{commands:{setConsent:{optionsValidator:a,run:function(e){var n=e.consent,r=e.identityMap,a=e.edgeConfigOverrides;o.suspend();var c=u.lookup(n);return t.addTask((function(){return c.isNew()?i({consentOptions:n,identityMap:r,edgeConfigOverrides:a}):Promise.resolve()})).then((function(){return c.save()})).finally(p)}}},lifecycle:{onResponse:p,onRequestFailure:p}}}({storedConsent:s,taskQueue:d,defaultConsent:c,consent:o,sendSetConsentRequest:l,validateSetConsentOptions:ra,consentHashStore:p,doesIdentityCookieExist:g})};oa.namespace="Privacy";var ia=function(){return{eventMergeId:fc()}},aa=function(){return{commands:{createEventMergeId:{run:{createEventMergeId:ia}.createEventMergeId}}}};aa.namespace="EventMerge";var ua=function(e){var n=function(e){var n=e.config,t=e.componentRegistry,r=[].concat(ac(t.getCommandNames()),[zn,Jn]).sort(),o=rc({},n);Object.keys(n).forEach((function(e){var t=n[e];"function"==typeof t&&(o[e]=t.toString())}));var i=t.getComponentNames();return{version:ji,configs:o,commands:r,components:i}}({config:e.config,componentRegistry:e.componentRegistry});return{commands:{getLibraryInfo:{run:function(){return{libraryInfo:n}}}}}};ua.namespace="LibraryInfo";var ca,sa=function(e){return null!==e&&"object"===cc(e)&&Object.getPrototypeOf(e)===Object.prototype},da=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object.keys(e).forEach((function(r){sa(e[r])||Array.isArray(e[r])?da(e[r],n,[].concat(ac(t),[r])):n[[].concat(ac(t),[r]).join(".")]=e[r]})),n},la=function(e){return sa(e)?da(e):e},fa={MATCHER:"matcher",GROUP:"group",HISTORICAL:"historical"},pa={EQUALS:"eq",NOT_EQUALS:"ne",EXISTS:"ex",NOT_EXISTS:"nx",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"ge",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"le",CONTAINS:"co",NOT_CONTAINS:"nc",STARTS_WITH:"sw",ENDS_WITH:"ew"},ga={AND:"and",OR:"or"},ma={ANY:"any",ORDERED:"ordered"},va=(nc(nc(nc(nc(nc(nc(nc(nc(nc(nc(ca={},pa.EQUALS,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&r===String(t[o]).toLowerCase())return!0;return!1}}),pa.NOT_EQUALS,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&r===String(t[o]).toLowerCase())return!1;return!0}}),pa.EXISTS,{matches:function(e,n){return void 0!==e[n]&&null!==e[n]}}),pa.NOT_EXISTS,{matches:function(e,n){return void 0===e[n]||null===e[n]}}),pa.GREATER_THAN,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Cc(r))return!1;for(var o=0;o<t.length;o+=1)if(Cc(t[o])&&r>t[o])return!0;return!1}}),pa.GREATER_THAN_OR_EQUAL_TO,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Cc(r))return!1;for(var o=0;o<t.length;o+=1)if(Cc(t[o])&&r>=t[o])return!0;return!1}}),pa.LESS_THAN,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Cc(r))return!1;for(var o=0;o<t.length;o+=1)if(Cc(t[o])&&r<t[o])return!0;return!1}}),pa.LESS_THAN_OR_EQUAL_TO,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=e[n];if(!Cc(r))return!1;for(var o=0;o<t.length;o+=1)if(Cc(t[o])&&r<=t[o])return!0;return!1}}),pa.CONTAINS,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&-1!==r.indexOf(String(t[o]).toLowerCase()))return!0;return!1}}),pa.NOT_CONTAINS,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&-1!==r.indexOf(String(t[o]).toLowerCase()))return!1;return!0}}),nc(nc(ca,pa.STARTS_WITH,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&r.startsWith(String(t[o]).toLowerCase()))return!0;return!1}}),pa.ENDS_WITH,{matches:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(Ic(e[n]))return!1;for(var r=String(e[n]).toLowerCase(),o=0;o<t.length;o+=1)if(!Ic(t[o])&&r.endsWith(t[o].toLowerCase()))return!0;return!1}})),ha=["iam.eventType","eventType","type"],ya=["iam.id","id"],wa=function(e){var n=e.scopeDetails,t=(void 0===n?{}:n).activity;return(void 0===t?{}:t).id},ba=function(e){e.clear()},Ea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];return Array.isArray(e)?(e.forEach((function(e){Array.isArray(e)?n.push.apply(n,ac(Ea(e))):n.push(e)})),n):e},Ia=nc(nc({},"cjmiam",(function(e,n,t){var r=t.html,o=t.mobileParameters;return{schema:fr,data:{mobileParameters:o,webParameters:{},content:r,contentType:mi},id:e}})),"schema",(function(e,n,t){return{schema:t.schema,data:t.data,id:t.id||e}})),Ca=function(e){var n=e.schema,t=e.data;if(n===dr)return!0;if(n!==sr)return!1;try{var r="string"==typeof t.content?JSON.parse(t.content):t.content;return r&&Object.prototype.hasOwnProperty.call(r,"version")&&Object.prototype.hasOwnProperty.call(r,"rules")}catch(e){return!1}},Sa=function(e,n,t){var r=function(e){var n=e.id,t=e.type,r=e.detail;return"function"==typeof Ia[t]?Ia[t](n,t,r):r},o=wa(e),i=[];return Array.isArray(e.items)&&e.items.filter(Ca).forEach((function(e){var n=e.data,t=void 0===n?{}:n,r=e.schema===dr?t:t.content;r&&i.push(xc("string"==typeof r?JSON.parse(r):r))})),{evaluate:function(a){var u=n.getEvent(mr,o),c=u?u.firstTimestamp:void 0,s=Ea(i.map((function(e){return e.execute(a)}))).map(r).map((function(e){var n=(t.recordQualified(o)||{}).firstTimestamp;return rc(rc({},e),{},{data:rc(rc({},e.data),{},{qualifiedDate:n,displayedDate:c})})}));return rc(rc({},e),{},{items:s})},isEvaluable:i.length>0}},ka=function(e){var n=e.eventRegistry,t={},r=function(e){var n=e.eventRegistry;return{recordQualified:function(e){if(e)return n.addEvent({},wr.TRIGGER,e)}}}({eventRegistry:n}),o=function(e){var o=wa(e);if(o){var i=Sa(e,n,r);i.isEvaluable&&(t[o]=i)}};return{addPayload:o,addPayloads:function(e){e.forEach(o)},evaluate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.values(t).map((function(n){return n.evaluate(e)})).filter((function(e){return e.items.length>0}))}}},Ta="events",Da=function(e){return"iam."+e},Pa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return function(t){var r={};return Object.keys(t).forEach((function(o){r[o]={},Object.values(t[o]).filter((function(e){return new Date(e.firstTimestamp)>=function(e){var n=new Date;return n.setDate(n.getDate()-e),n}(n)})).sort((function(e,n){return e.firstTimestamp-n.firstTimestamp})).slice(-1*e).forEach((function(e){r[o][e.event[Da("id")]]=e}))})),r}},Ra=function(e){var n,t,r,o=e.storage,i=o,a=function(e){n=function(e,n){return function(t){var r=e.getItem(n);if(!r)return t;try{return JSON.parse(r)}catch(e){return t}}}(i=e,Ta),t=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e};return function(r){e.setItem(n,JSON.stringify(t(r)))}}(i,Ta,Pa(1e3,30)),r=n({})};a(o);var u=function(e,n,o,i){if(n&&o){r[n]||(r[n]={});var a=r[n][o],u=a?a.count:0,c=(new Date).getTime(),s=a?a.firstTimestamp||a.timestamp:c;return r[n][o]={event:rc(rc({},e),{},nc(nc(nc({},Da("id"),o),Da("eventType"),n),Da("action"),i)),firstTimestamp:s,timestamp:c,count:u+1},t(r),r[n][o]}};return{addExperienceEdgeEvent:function(e){var n=e.getContent().xdm,t=void 0===n?{}:n,r=t._experience;if(function(e){var n=e.eventType,t=void 0===n?"":n,r=e._experience;return!(!t||""===t||!r||"object"!==cc(r))}(t)){var o=r.decisioning,i=void 0===o?{}:o,a=i.propositionEventType,c=void 0===a?{}:a,s=i.propositionAction,d=void 0===s?{}:s,l=i.propositions,f=void 0===l?[]:l,p=Object.keys(c);if(0!==p.length){var g=d.id;p.filter((function(e){return 1===c[e]})).forEach((function(e){f.forEach((function(n){(function(e){var n=e.scopeDetails;return(void 0===n?{}:n).decisionProvider})(n)===Mi&&u({},e,wa(n),g)}))}))}}},addEvent:u,getEvent:function(e,n){if(r[e])return r[e][n]},toJSON:function(){return r},setStorage:a}},Oa=function(e){var n=e.eventRegistry,t=e.window,r=(new Date).getTime(),o={browser:{name:Rt(t)},page:rc({title:t.title,url:t.url},Ie(t.url)),referringPage:rc({url:t.referrer},Ie(t.referrer))},i=function(){return rc(rc(rc({},o),(e=new Date,n=e.getTime(),{pageLoadTimestamp:r,currentTimestamp:n,currentDate:e.getDate(),"~state.com.adobe.module.lifecycle/lifecyclecontextdata.dayofweek":e.getDay()+1,"~state.com.adobe.module.lifecycle/lifecyclecontextdata.hourofday":e.getHours(),currentMinute:e.getMinutes(),currentMonth:e.getMonth(),currentYear:e.getFullYear(),pageVisitDuration:n-r,"~timestampu":n/1e3,"~timestampz":e.toISOString()})),{},{window:{height:t.height,width:t.width,scrollY:t.scrollY,scrollX:t.scrollX},"~sdkver":ji});var e,n};return{getContext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=rc(rc({},i()),e);return rc(rc({},la(t)),{},{events:n.toJSON()})}}},Aa=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return t},Na=function(e){return!0},Ma=function(){var e=Aa,n=Na,t=0,r={};return{add:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return"function"!=typeof e?function(){}:(r[t+=1]={callback:e,params:o},n=t,function(){delete r[n]})},emit:function(){for(var t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];kn(r).forEach((function(t){var r=t.callback,i=t.params,a=e.apply(void 0,[i].concat(o));n.apply(void 0,[i].concat(ac(a)))&&r.apply(void 0,ac(a))}))},hasSubscriptions:function(){return Object.keys(r).length>0},setEmissionPreprocessor:function(n){"function"==typeof n&&(e=n)},setEmissionCondition:function(e){"function"==typeof e&&(n=e)}}},xa=function(e,n){var t=e.surfacesFilter,r=e.schemasFilter;return[{propositions:n.filter((function(e){return!t||l(t,e.scope)})).map((function(e){var n=e.items,t=void 0===n?[]:n;return rc(rc({},e),{},{items:t.filter((function(e){return!r||l(r,e.schema)}))})})).filter((function(e){return e.items.length>0}))}]},qa=function(e,n){return n.propositions.length>0},La=function(){var e=Ma();e.setEmissionPreprocessor(xa),e.setEmissionCondition(qa);return{refresh:function(n){e.hasSubscriptions()&&e.emit(n)},command:{optionsValidator:function(e){return function(e){var n=e.options;return bn({surfaces:gn(En()).uniqueItems(),schemas:gn(En()).uniqueItems(),callback:vn().required()}).noUnknownFields()(n)}({options:e})},run:function(n){var t=n.surfaces,r=n.schemas,o=n.callback,i=e.add(o,{surfacesFilter:t instanceof Array?t:void 0,schemasFilter:r instanceof Array?r:void 0});return Promise.resolve({unsubscribe:i})}}}},_a="~type",ja="~source",Ua="com.adobe.eventType.edge",Fa="com.adobe.eventType.rulesEngine",Ba="com.adobe.eventSource.requestContent",Ha=function(e){var n=e.contextProvider,t=e.decisionProvider;return{optionsValidator:function(e){return function(e){var n=e.options;return bn({renderDecisions:mn(),personalization:bn({decisionContext:bn({})})}).noUnknownFields()(n)}({options:e})},run:function(e){var r=e.renderDecisions,o=e.decisionContext;return(0,e.applyResponse)({renderDecisions:r,propositions:t.evaluate(n.getContext(o))})}}},Va=function(e){var n=e.config,t=e.createNamespacedStorage,r=e.consent,o=n.orgId,i=n.personalizationStorageEnabled,a=t(ae(o)+".decisioning.");i||ba(a.persistent);var u,c,s=Ra({storage:(u={},{getItem:function(e){return e in u?u[e]:null},setItem:function(e,n){u[e]=n}})}),d=ka({eventRegistry:s}),l=Oa({eventRegistry:s,window:window}),f=Ha({contextProvider:l,decisionProvider:d}),p=La();return{lifecycle:{onDecision:function(e){var n=e.propositions;p.refresh(n)},onComponentsRegistered:function(e){var n;n=e.lifecycle,c=function(e){var t=e.renderDecisions,r=void 0!==t&&t,o=e.propositions,i=void 0===o?[]:o,a=e.event,u=e.personalization;return i.length>0&&n&&n.onDecision({renderDecisions:r,propositions:i,event:a,personalization:u}),{propositions:i}},i&&r.awaitConsent().then((function(){s.setStorage(a.persistent)})).catch((function(){a&&ba(a.persistent)}))},onBeforeEvent:function(e){var n=e.event,t=e.renderDecisions,r=e.personalization,o=void 0===r?{}:r,i=e.onResponse,a=void 0===i?he:i,u=o.decisionContext,f=void 0===u?{}:u;a(function(e){var n=e.renderDecisions,t=e.decisionProvider,r=e.applyResponse,o=e.event,i=e.personalization,a=e.decisionContext,u=rc(rc({},la(o.getContent())),a);return function(e){var a=e.response;if(t.addPayloads(a.getPayloadsByType("personalization:decisions")),!o.hasQuery())return{propositions:[]};var c=t.evaluate(u);return r({renderDecisions:n,propositions:c,event:o,personalization:i})}}({renderDecisions:t,decisionProvider:d,applyResponse:c,event:n,personalization:o,decisionContext:l.getContext(rc(nc(nc({},_a,Ua),ja,Ba),f))})),s.addExperienceEdgeEvent(n)}},commands:{evaluateRulesets:{run:function(e){var n=e.renderDecisions,t=e.personalization,r=(void 0===t?{}:t).decisionContext,o=void 0===r?{}:r;return f.run({renderDecisions:n,decisionContext:rc(nc(nc({},_a,Fa),ja,Ba),o),applyResponse:c})},optionsValidator:f.optionsValidator},subscribeRulesetItems:p.command}}};Va.namespace="DecisioningEngine",Va.configValidators=bn({personalizationStorageEnabled:mn().default(!1)});var za=function(e){return{inferences:e.response.getPayloadsByType("rtml:inferences")}},Ja=function(){return{lifecycle:{onResponse:za},commands:{}}};Ja.namespace="MachineLearning";var Qa="main",Ga="completed",Xa=function(){var e;return{getSession:function(n){return e[n]||{}},storeSession:function(n){var t=n.playerId,r=n.sessionDetails;void 0===e&&(e={}),e[t]=r},stopPing:function(n){var t=n.playerId,r=e[t];r&&(clearTimeout(r.pingId),r.pingId=null,r.playbackState=Ga)},savePing:function(n){var t=n.playerId,r=n.pingId,o=n.playbackState;e[t]&&(e[t].pingId&&clearTimeout(e[t].pingId),e[t].pingId=r,e[t].playbackState=o)}}},Wa={PAUSE:"media.pauseStart",PLAY:"media.play",BUFFER_START:"media.bufferStart",AD_START:"media.adStart",Ad_BREAK_START:"media.adBreakStart",SESSION_END:"media.sessionEnd",SESSION_START:"media.sessionStart",SESSION_COMPLETE:"media.sessionComplete",PING:"media.ping",AD_BREAK_COMPLETE:"media.adBreakComplete",AD_COMPLETE:"media.adComplete",AD_SKIP:"media.adSkip",BITRATE_CHANGE:"media.bitrateChange",CHAPTER_COMPLETE:"media.chapterComplete",CHAPTER_SKIP:"media.chapterSkip",CHAPTER_START:"media.chapterStart",ERROR:"media.error",STATES_UPDATE:"media.statesUpdate"},Ya=function(e){var n=e.config,t=e.eventManager,r=e.consent,o=e.sendEdgeNetworkRequest,i=e.setTimestamp;return{createMediaEvent:function(e){var r=e.options,o=t.createEvent(),a=r.xdm;if(i(a),o.setUserXdm(a),a.eventType===Wa.AD_START){var u=r.xdm.mediaCollection.advertisingDetails;o.mergeXdm({mediaCollection:{advertisingDetails:{playerName:u.playerName||n.streamingMedia.playerName}}})}return o},createMediaSession:function(e){var r=n.streamingMedia,o=r.playerName,i=r.channel,a=r.appVersion,u=t.createEvent(),c=e.xdm.mediaCollection.sessionDetails;return u.setUserXdm(e.xdm),u.mergeXdm({eventType:Wa.SESSION_START,mediaCollection:{sessionDetails:{playerName:c.playerName||o,channel:c.channel||i,appVersion:c.appVersion||a}}}),u},augmentMediaEvent:function(e){var n=e.event,t=e.playerId,r=e.getPlayerDetails,o=e.sessionID;if(!t||!r)return n;var i=r({playerId:t}),a=i.playhead,u=i.qoeDataDetails;return n.mergeXdm({mediaCollection:{playhead:Pe(a),qoeDataDetails:u,sessionID:o}}),n},trackMediaSession:function(e){var n=e.event,r=e.mediaOptions;return t.sendEvent(n,{mediaOptions:r})},trackMediaEvent:function(e){var n=e.event,t=e.action,i=_t(),a=function(e){var n=e.mediaRequestPayload,t=e.action;return Mt({payload:n,edgeSubPath:"/va",getAction:function(){return t},getUseSendBeacon:function(){return!1}})}({mediaRequestPayload:i,action:t});return i.addEvent(n),n.finalize(),r.awaitConsent().then((function(){return o({request:a}).then((function(){return{}}))}))}}},Ka=function(e){var n=e.mediaEventManager,t=e.mediaSessionCacheManager,r=e.config,o=function(e){var i=n.createMediaEvent({options:e}),a=e.playerId,u=e.xdm.eventType,c=u.split(".")[1],s=t.getSession(a),d=s.getPlayerDetails,l=s.sessionPromise,f=s.playbackState;return l.then((function(e){return e.sessionId?(n.augmentMediaEvent({event:i,eventType:u,playerId:a,getPlayerDetails:d,sessionID:e.sessionId}),n.trackMediaEvent({event:i,action:c}).then((function(){if(a)if(u===Wa.SESSION_COMPLETE||u===Wa.SESSION_END)t.stopPing({playerId:a});else{var e=function(e,n){return e===Wa.AD_START||e===Wa.Ad_BREAK_START||e===Wa.AD_SKIP||e===Wa.AD_COMPLETE?"ad":e===Wa.AD_BREAK_COMPLETE||e===Wa.CHAPTER_COMPLETE||e===Wa.CHAPTER_START||e===Wa.CHAPTER_SKIP||e===Wa.SESSION_START?"main":e===Wa.SESSION_END||e===Wa.SESSION_COMPLETE?"completed":n}(u,f);if("completed"===e)return;var n="ad"===e?r.streamingMedia.adPingInterval:r.streamingMedia.mainPingInterval,i=setTimeout((function(){o({playerId:a,xdm:{eventType:Wa.PING}})}),1e3*n);t.savePing({playerId:a,pingId:i,playbackState:e})}}))):Promise.reject(new Error("Failed to trigger media event: "+u+". Session ID is not available for playerId: "+a+"."))}))};return function(e){return o(e)}},$a=bn({streamingMedia:bn({channel:En().nonEmpty().required(),playerName:En().nonEmpty().required(),appVersion:En(),mainPingInterval:yn().minimum(10).maximum(50).default(10),adPingInterval:yn().minimum(1).maximum(10).default(10)}).noUnknownFields()}),Za=function(e){var n=e.config,t=e.trackMediaEvent,r=e.trackMediaSession,o=e.mediaResponseHandler;return{lifecycle:{onBeforeEvent:function(e){var n=e.mediaOptions,t=e.onResponse,r=void 0===t?he:t;if(n){var i=n.legacy,a=n.playerId,u=n.getPlayerDetails;i||r((function(e){var n=e.response;return o({playerId:a,getPlayerDetails:u,response:n})}))}}},commands:{createMediaSession:{optionsValidator:function(e){return function(e){var n=e.options;return fn([bn({playerId:En().required(),getPlayerDetails:vn().required(),xdm:bn({mediaCollection:bn({sessionDetails:bn(pn()).required()})})}).required(),bn({xdm:bn({mediaCollection:bn({playhead:yn().required(),sessionDetails:bn(pn()).required()})})}).required()],"Error validating the createMediaSession command options.")(n)}({options:e})},run:r},sendMediaEvent:{optionsValidator:function(e){return function(e){var n=e.options;return fn([bn({playerId:En().required(),xdm:bn({eventType:In.apply(void 0,ac(Object.values(Wa))).required(),mediaCollection:bn(pn())}).required()}).required(),bn({xdm:bn({eventType:In.apply(void 0,ac(Object.values(Wa))).required(),mediaCollection:bn({playhead:yn().integer().required(),sessionID:En().required()}).required()}).required()}).required()],"Error validating the sendMediaEvent command options.")(n)}({options:e})},run:function(e){return n.streamingMedia?t(e):Promise.reject(new Error("Streaming media is not configured."))}}}}},eu=function(e){var n=e.config,t=e.mediaEventManager,r=e.mediaSessionCacheManager,o=e.legacy,i=void 0!==o&&o;return function(e){if(!n.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));var o=e.playerId,a=e.getPlayerDetails,u=t.createMediaSession(e);t.augmentMediaEvent({event:u,playerId:o,getPlayerDetails:a});var c=t.trackMediaSession({event:u,mediaOptions:{playerId:o,getPlayerDetails:a,legacy:i}});return r.storeSession({playerId:o,sessionDetails:{sessionPromise:c,getPlayerDetails:a,playbackState:Qa}}),c}},nu=function(e){var n=e.mediaSessionCacheManager,t=e.config,r=e.trackMediaEvent;return function(e){var o=e.response,i=e.playerId,a=e.getPlayerDetails,u=o.getPayloadsByType("media-analytics:new-session");if(_(u)){var c=u[0].sessionId;if(ti(c))return{};if(!i||!a)return{sessionId:c};var s=setTimeout((function(){r({playerId:i,xdm:{eventType:Wa.PING}})}),1e3*t.streamingMedia.mainPingInterval);return n.savePing({playerId:i,pingId:s,playbackState:Qa}),{sessionId:c}}return{}}},tu=function(e){var n=e.config,t=e.logger,r=e.eventManager,o=e.sendEdgeNetworkRequest,i=e.consent,a=Xa(),u=Ya({config:n,eventManager:r,logger:t,consent:i,sendEdgeNetworkRequest:o,setTimestamp:_i((function(){return new Date}))}),c=Ka({mediaSessionCacheManager:a,mediaEventManager:u,config:n}),s=eu({config:n,mediaEventManager:u,mediaSessionCacheManager:a}),d=nu({mediaSessionCacheManager:a,config:n,trackMediaEvent:c});return Za({config:n,trackMediaEvent:c,mediaEventManager:u,mediaResponseHandler:d,trackMediaSession:s})};tu.namespace="Streaming media",tu.configValidators=$a;var ru={Video:"video",Audio:"audio"},ou={VOD:"vod",Live:"live",Linear:"linear",Podcast:"podcast",Audiobook:"audiobook",AOD:"aod"},iu={FullScreen:"fullScreen",ClosedCaption:"closedCaptioning",Mute:"mute",PictureInPicture:"pictureInPicture",InFocus:"inFocus"},au={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",StateStart:"stateStart",StateEnd:"stateEnd"},uu="sessionStart",cu="sessionEnd",su="sessionComplete",du="play",lu="pauseStart",fu="error",pu="statesUpdate",gu={MediaResumed:"media.resumed",GranularAdTracking:"media.granularadtracking"},mu={Show:"a.media.show",Season:"a.media.season",Episode:"a.media.episode",AssetId:"a.media.asset",Genre:"a.media.genre",FirstAirDate:"a.media.airDate",FirstDigitalDate:"a.media.digitalDate",Rating:"a.media.rating",Originator:"a.media.originator",Network:"a.media.network",ShowType:"a.media.type",AdLoad:"a.media.adLoad",MVPD:"a.media.pass.mvpd",Authorized:"a.media.pass.auth",DayPart:"a.media.dayPart",Feed:"a.media.feed",StreamFormat:"a.media.format"},vu={Artist:"a.media.artist",Album:"a.media.album",Label:"a.media.label",Author:"a.media.author",Station:"a.media.station",Publisher:"a.media.publisher"},hu={Advertiser:"a.media.ad.advertiser",CampaignId:"a.media.ad.campaign",CreativeId:"a.media.ad.creative",PlacementId:"a.media.ad.placement",SiteId:"a.media.ad.site",CreativeUrl:"a.media.ad.creativeURL"},yu=function(e){var n=e.logger;return{createMediaObject:function(e,t,r,o,i){var a={friendlyName:e,name:t,length:r,streamType:i,contentType:o},u=bn({friendlyName:En().nonEmpty(),name:En().nonEmpty(),length:yn().required(),streamType:En().nonEmpty(),contentType:En().nonEmpty()});try{var c=u(a);return{sessionDetails:{name:c.name,friendlyName:c.friendlyName,length:c.length,streamType:c.streamType,contentType:c.contentType}}}catch(e){return n.warn("An error occurred while creating the Media Object.",e),{}}},createAdBreakObject:function(e,t,r){var o={friendlyName:e,offset:t,index:r},i=bn({friendlyName:En().nonEmpty(),offset:yn(),index:yn()});try{var a=i(o);return{advertisingPodDetails:{friendlyName:a.friendlyName,offset:a.offset,index:a.index}}}catch(e){return n.warn("An error occurred while creating the Ad Break Object.",e),{}}},createAdObject:function(e,t,r,o){var i={friendlyName:e,name:t,podPosition:r,length:o},a=bn({friendlyName:En().nonEmpty(),name:En().nonEmpty(),podPosition:yn(),length:yn()});try{var u=a(i);return{advertisingDetails:{friendlyName:u.friendlyName,name:u.name,podPosition:u.podPosition,length:u.length}}}catch(e){return n.warn("An error occurred while creating the Advertising Object.",e),{}}},createChapterObject:function(e,t,r,o){var i={friendlyName:e,offset:t,length:r,index:o},a=bn({friendlyName:En().nonEmpty(),offset:yn(),length:yn(),index:yn()});try{var u=a(i);return{chapterDetails:{friendlyName:u.friendlyName,offset:u.offset,index:u.index,length:u.length}}}catch(e){return n.warn("An error occurred while creating the Chapter Object.",e),{}}},createStateObject:function(e){var t=En().matches(/^[a-zA-Z0-9_]{1,64}$/,"This is not a valid state name.");try{return{name:t(e)}}catch(e){return n.warn("An error occurred while creating the State Object.",e),{}}},createQoEObject:function(e,t,r,o){var i={bitrate:e,droppedFrames:t,fps:r,startupTime:o},a=bn({bitrate:yn(),droppedFrames:yn(),fps:yn(),startupTime:yn()});try{var u=a(i);return{bitrate:u.bitrate,droppedFrames:u.droppedFrames,framesPerSecond:u.fps,timeToStart:u.startupTime}}catch(e){return n.warn("An error occurred while creating the QOE Object.",e),{}}}}},wu={"a.media.show":"show","a.media.season":"season","a.media.episode":"episode","a.media.asset":"assetID","a.media.genre":"genre","a.media.airDate":"firstAirDate","a.media.digitalDate":"firstDigitalDate","a.media.rating":"rating","a.media.originator":"originator","a.media.network":"network","a.media.type":"showType","a.media.adLoad":"adLoad","a.media.pass.mvpd":"mvpd","a.media.pass.auth":"authorized","a.media.dayPart":"dayPart","a.media.feed":"feed","a.media.format":"streamFormat","a.media.artist":"artist","a.media.album":"album","a.media.label":"label","a.media.author":"author","a.media.station":"station","a.media.publisher":"publisher","media.resumed":"hasResume"},bu={"a.media.ad.advertiser":"advertiser","a.media.ad.campaign":"campaignID","a.media.ad.creative":"creativeID","a.media.ad.placement":"placementID","a.media.ad.site":"siteID","a.media.ad.creativeURL":"creativeURL"},Eu=function(e){var n=e.logger,t=e.trackMediaSession,r=e.trackMediaEvent,o=e.uuid,i=null,a=function(e){var n=e.eventType,t=e.mediaDetails,r=void 0===t?{}:t,o=e.contextData,i=void 0===o?[]:o,a=function(e){var n=e.eventType;return n===au.BufferComplete||n===au.SeekComplete?du:n===au.StateStart||n===au.StateEnd?pu:n===au.SeekStart?lu:n}({eventType:n});if(n===au.StateStart)return{eventType:"media."+a,mediaCollection:{statesStart:[r]}};if(n===au.StateEnd)return{eventType:"media."+a,mediaCollection:{statesEnd:[r]}};var u={eventType:"media."+a,mediaCollection:rc({},r)},c=[];return Object.keys(i).forEach((function(e){wu[e]?u.mediaCollection.sessionDetails[wu[e]]=i[e]:bu[e]?u.mediaCollection.advertisingDetails[bu[e]]=i[e]:c.push({name:e,value:i[e]})})),_(c)&&(u.mediaCollection.customMetadata=c),u};return{trackSessionStart:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(v(e)||ee(e))return n.warn("Invalid media object"),{};null===i&&(n.warn("The Media Session was completed. Restarting a new session."),i={qoe:null,lastPlayhead:0,playerId:o()});var u=a({eventType:uu,mediaDetails:e,contextData:r});return t({playerId:i.playerId,getPlayerDetails:function(){return{playhead:i.lastPlayhead,qoeDataDetails:i.qoe}},xdm:u})},trackPlay:function(){if(null===i)return n.warn("The Media Session was completed."),{};var e=a({eventType:du});return r({playerId:i.playerId,xdm:e})},trackPause:function(){if(null===i)return n.warn("The Media Session was completed."),{};var e=a({eventType:lu});return r({playerId:i.playerId,xdm:e})},trackSessionEnd:function(){if(null===i)return n.warn("The Media Session was completed."),{};var e=a({eventType:cu});return r({playerId:i.playerId,xdm:e})},trackComplete:function(){if(null===i)return n.warn("The Media Session was completed."),{};var e=a({eventType:su});return r({playerId:i.playerId,xdm:e})},trackError:function(e){if(n.warn("trackError("+e+")"),null===i)return n.warn("The Media Session was completed."),{};var t=a({eventType:fu,mediaDetails:{errorDetails:{name:e,source:"player"}}});return r({playerId:i.playerId,xdm:t})},trackEvent:function(e,t,o){if(ee(t))return n.warn("Invalid media object."),{};if(null===i)return n.warn("The Media Session was completed."),{};if(!l(Object.values(au),e))return n.warn("Invalid event type"),{};var u=a({eventType:e,mediaDetails:t,contextData:o});return r({playerId:i.playerId,xdm:u})},updatePlayhead:function(e){null!==i?pe(e)&&(i.lastPlayhead=parseInt(e,10)):n.warn("The Media Session was completed.")},updateQoEObject:function(e){null!==i?e&&(i.qoe=e):n.warn("The Media Session was completed.")},destroy:function(){n.warn("Destroy called, destroying the tracker."),i=null}}},Iu=function(e){var n=e.eventManager,t=e.sendEdgeNetworkRequest,r=e.config,o=e.logger,i=e.consent,a=Xa(),u=Ya({sendEdgeNetworkRequest:t,config:r,consent:i,eventManager:n,setTimestamp:_i((function(){return new Date}))}),c=Ka({mediaSessionCacheManager:a,mediaEventManager:u,config:r}),s=eu({config:r,mediaEventManager:u,mediaSessionCacheManager:a,legacy:!0});return function(e){var n=e.trackMediaEvent,t=e.trackMediaSession,r=e.mediaResponseHandler,o=e.logger,i=e.createMediaHelper,a=e.createGetInstance,u=e.config;return{lifecycle:{onBeforeEvent:function(e){var n=e.mediaOptions,t=e.onResponse,o=void 0===t?he:t;if(n){var i=n.legacy,a=n.playerId,u=n.getPlayerDetails;i&&o((function(e){var n=e.response;return r({playerId:a,getPlayerDetails:u,response:n})}))}}},commands:{getMediaAnalyticsTracker:{run:function(){if(!u.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));o.info("Streaming media is configured in legacy mode.");var e=i({logger:o});return Promise.resolve(rc({getInstance:function(){return a({logger:o,trackMediaEvent:n,trackMediaSession:t,uuid:fc})},Event:au,MediaType:ru,PlayerState:iu,StreamType:ou,MediaObjectKey:gu,VideoMetadataKeys:mu,AudioMetadataKeys:vu,AdMetadataKeys:hu},e))}}}}}({mediaResponseHandler:nu({mediaSessionCacheManager:a,config:r,trackMediaEvent:c}),trackMediaSession:s,trackMediaEvent:c,createMediaHelper:yu,createGetInstance:Eu,logger:o,config:r})};Iu.namespace="Legacy Media Analytics";var Cu,Su=[Wn,yt,zt,Gt,xi,Wi,oa,aa,ua,Ja,Va,Iu,tu],ku=function(e){var n=e.options,t=e.componentCreators,r=e.coreConfigValidators,o=e.createConfig,i=e.logger,a=e.setDebugEnabled,u=function(e){var n=[],t={get enabled(){return e.enabled},flush:function(){n.forEach((function(n){var t=n.method,r=n.args;return e[t].apply(e,ac(r))}))}};return Object.keys(e).filter((function(n){return"function"==typeof e[n]})).forEach((function(e){t[e]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n.push({method:e,args:r})}})),t}(i),c=t.map((function(e){return e.configValidators})).filter((function(e){return e})).reduce((function(e,n){return e.concat(n)}),r),s=o(function(e){var n=e.combinedConfigValidator,t=e.options,r=e.logger;try{return n.noUnknownFields().required().call({logger:r},t)}catch(e){throw new Error("Resolve these configuration problems:\n\t - "+e.message.split("\n").join("\n\t - ")+"\nFor configuration documentation see: https://adobe.ly/3sHh553")}}({combinedConfigValidator:c,options:n,logger:u}));a(s.debugEnabled,{fromConfig:!0}),u.flush();var d=function(e,n,t){return t.reduce((function(t,r){var o=r.buildOnInstanceConfiguredExtraParams;return o&&m(t,o({config:e,logger:n})),t}),{})}(s,i,t);return i.logOnInstanceConfigured(rc(rc({},d),{},{config:s})),s},Tu=function(e){return m({},e)},Du=function(e){var n=e.errorPrefix,t=e.logger;return function(e,r){var o=ke(e);if(o.code===Ln)return t.warn("The "+r+" could not fully complete. "+o.message),{};throw Te({error:o,message:n+" "+o.message}),o}},Pu=function(e){var n=e.getDebugEnabled,t=e.console,r=e.getMonitors,o=e.context,i="["+o.instanceName+"]";o.componentName&&(i+=" ["+o.componentName+"]");var a=function(e,n){var t=r();if(t.length>0){var i=m({},o,n);t.forEach((function(n){n[e]&&n[e](i)}))}},u=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];a("onBeforeLog",{level:e,arguments:o}),n()&&t[e].apply(t,[i].concat(o))};return{get enabled(){return r().length>0||n()},logOnInstanceCreated:function(e){a("onInstanceCreated",e),u("info","Instance initialized.")},logOnInstanceConfigured:function(e){a("onInstanceConfigured",e),u("info","Instance configured. Computed configuration:",e.config)},logOnBeforeCommand:function(e){a("onBeforeCommand",e),u("info","Executing "+e.commandName+" command. Options:",e.options)},logOnCommandResolved:function(e){a("onCommandResolved",e),u("info",e.commandName+" command resolved. Result:",e.result)},logOnCommandRejected:function(e){a("onCommandRejected",e),u("error",e.commandName+" command was rejected. Error:",e.error)},logOnBeforeNetworkRequest:function(e){a("onBeforeNetworkRequest",e),u("info","Request "+e.requestId+": Sending request.",e.payload)},logOnNetworkResponse:function(e){a("onNetworkResponse",e);var n=e.parsedBody||e.body?"response body:":"no response body.";u("info","Request "+e.requestId+": Received response with status code "+e.statusCode+" and "+n,e.parsedBody||e.body)},logOnNetworkError:function(e){a("onNetworkError",e),u("error","Request "+e.requestId+": Network request failed.",e.error)},info:u.bind(null,"info"),warn:u.bind(null,"warn"),error:u.bind(null,"error")}},Ru=["edgeConfigOverrides"],Ou="Event was canceled because the onBeforeEventSend callback returned false.",Au=function(e){var n=e.orgId,t=e.targetMigrationEnabled;return function(e){return function(e,n){return 0===n.indexOf(ie+"_"+ae(e)+"_")}(n,e)||"at_qa_mode"===e||t&&"mbox"===e}},Nu=function(e){var n=e.shift()||[],t=e.shift()||[],r=e;return y.apply(void 0,[{}].concat(ac(n),ac(t),ac(r)))},Mu=function(e){return function(n){var t=function(){throw n};return e.call({error:n}).then(t,t)}},xu="The server responded with a",qu=function(e){var n=e.orgId,t=e.cookieJar,r=ue(n,"cluster");return function(){return t.get(r)||function(){var e=t.get("mboxEdgeCluster");if(e)return"t"+e}()}},Lu=[429,503,502,504],_u=function(e){var n=e.response;return e.retriesAttempted<3&&l(Lu,n.statusCode)},ju=function(e){var n=e.response,t=e.retriesAttempted,r=function(e){var n,t=e.getHeader("Retry-After");if(t){var r=parseInt(t,10);n=ge(r)?1e3*r:Math.max(0,new Date(t).getTime()-(new Date).getTime())}return n}(n);return void 0===r&&(r=function(e){var n=1e3+1e3*e,t=.3*n,r=n-t,o=n+t;return Math.round(r+Math.random()*(o-r))}(t)),r},Uu=le(window),Fu=window,Bu=Fu.console,Hu=Fu.fetch,Vu=Fu.navigator,zu=Fu.XMLHttpRequest,Ju=function(){return window.__alloyMonitors||[]},Qu=bn({debugEnabled:mn().default(!1),defaultConsent:In(Nn,Mn,xn).default(Nn),datastreamId:En().unique().required(),edgeDomain:En().domain().default("edge.adobedc.net"),edgeBasePath:En().nonEmpty().default("ee"),orgId:En().unique().required(),onBeforeEventSend:vn().default(he),edgeConfigOverrides:Sn}).renamed("edgeConfigId",En().unique(),"datastreamId"),Gu=function(e,n){for(var t,r,o="",i=e.location.hostname.toLowerCase().split("."),a=1;a<i.length&&!n.get(oe);)o=(t=i,r=a+=1,t.slice(-r)).join("."),n.set(oe,oe,{domain:o});return n.remove(oe,{domain:o}),o}(window,b),Xu=L(Hu)?function(e){var n=e.fetch;return function(e,t){return n(e,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrerPolicy:"no-referrer-when-downgrade",body:t}).then((function(e){return e.text().then((function(n){return{statusCode:e.status,getHeader:function(n){return e.headers.get(n)},body:n}}))}))}}({fetch:Hu}):function(e){var n=e.XMLHttpRequest;return function(e,t){return new Promise((function(r,o){var i=new n;i.onreadystatechange=function(){4===i.readyState&&(0===i.status?o(new Error("Request aborted.")):r({statusCode:i.status,getHeader:function(e){return i.getResponseHeader(e)},body:i.responseText}))},i.onloadstart=function(){i.responseType="text"},i.open("POST",e,!0),i.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),i.withCredentials=!0,i.onerror=o,i.onabort=o,i.send(t)}))}}({XMLHttpRequest:zu}),Wu=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.appendNode,r=void 0===t?O:t,o=n.awaitSelector,i=void 0===o?Y:o,a=n.createNode,u=void 0===a?A:a,c=n.fireImage,s=void 0===c?q:c,d=s,l=function(n){var t=n.src;return i("BODY").then((function(n){var t=ic(n,1)[0];return e||(e=u("IFRAME",$,Z),r(t,e))})).then((function(e){var n=e.contentWindow.document;return s({src:t,currentDocument:n})}))};return function(e){var n=e.hideReferrer,t=e.url;return n?l({src:t}):d({src:t})}}(),Yu=function(e){var n=e.window,t=(0,e.createNamespacedStorage)("validation.");return function(){var e=Se.parse(n.location.search).adb_validation_sessionid;if(!e)return"";var r=function(e){var n=e.persistent.getItem(Ft);return n||(n=fc(),e.persistent.setItem(Ft,n)),n}(t),o=e+"|"+r;return"&"+Se.stringify({adobeAepValidationToken:o})}}({window:window,createNamespacedStorage:Uu}),Ku=function(e){var n=e.instanceName,t=e.logController,r=t.setDebugEnabled,o=t.logger,i=t.createComponentLogger,a=An(),u=Rn(a),c=k({logger:o,cookieJar:b}),s=Du({errorPrefix:"["+n+"]",logger:o}),d=Qn({logger:o,configureCommand:function(e){var t=ku({options:e,componentCreators:Su,coreConfigValidators:Qu,createConfig:Tu,logger:o,setDebugEnabled:r}),s=t.orgId,d=t.targetMigrationEnabled,l=Au({orgId:s,targetMigrationEnabled:d}),f=function(e){var n=e.cookieJar,t=e.shouldTransferCookie,r=e.apexDomain,o=e.dateProvider;return{cookiesToPayload:function(e,o){var i,a=(i=r,o.substr(-i.length)===i),u={domain:r,cookiesEnabled:!0};if(!a){var c=n.get(),s=Object.keys(c).filter(t).map((function(e){return{key:e,value:c[e]}}));s.length&&(u.entries=s)}e.mergeState(u)},responseToCookies:function(e){e.getPayloadsByType("state:store").forEach((function(e){var t={domain:r},i=e.attrs&&e.attrs.SameSite&&e.attrs.SameSite.toLowerCase();void 0!==e.maxAge&&(t.expires=new Date(o().getTime()+1e3*e.maxAge)),void 0!==i&&(t.sameSite=i),"none"===i&&(t.secure=!0),n.set(e.key,e.value,t)}))}}}({cookieJar:c,shouldTransferCookie:l,apexDomain:Gu,dateProvider:function(){return new Date}}),p=L(Vu.sendBeacon)?function(e){var n=e.sendBeacon,t=e.sendFetchRequest,r=e.logger;return function(e,o){var i=new Blob([o],{type:"text/plain; charset=UTF-8"});return n(e,i)?Promise.resolve({statusCode:204,getHeader:function(){return null},body:""}):(r.info("Unable to use `sendBeacon`; falling back to `fetch`."),t(e,o))}}({sendBeacon:Vu.sendBeacon.bind(Vu),sendFetchRequest:Xu,logger:o}):Xu,g=function(e){var n=e.logger,t=e.sendFetchRequest,r=e.sendBeaconRequest,o=e.isRequestRetryable,i=e.getRequestRetryDelay;return function(e){var a=e.requestId,u=e.url,c=e.payload,s=e.useSendBeacon,d=JSON.stringify(c),l=JSON.parse(d);n.logOnBeforeNetworkRequest({url:u,requestId:a,payload:l});var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(s?r:t)(u,d).then((function(t){var r;if(o({response:t,retriesAttempted:e})){var c=i({response:t,retriesAttempted:e});return new Promise((function(n){setTimeout((function(){n(f(e+1))}),c)}))}try{r=JSON.parse(t.body)}catch(e){}return n.logOnNetworkResponse(rc(rc({requestId:a,url:u,payload:l},t),{},{parsedBody:r,retriesAttempted:e})),{statusCode:t.statusCode,body:t.body,parsedBody:r,getHeader:t.getHeader}}))};return f().catch((function(e){throw n.logOnNetworkError({requestId:a,url:u,payload:l,error:e}),De({error:e,message:"Network request failed."})}))}}({logger:o,sendFetchRequest:Xu,sendBeaconRequest:p,isRequestRetryable:_u,getRequestRetryDelay:ju}),m=function(e){var n=e.logger;return function(e){var t=e.statusCode,r=e.body,o=e.parsedBody;if(t<200||t>=300||!o&&204!==t||o&&!Array.isArray(o.handle)){var i=o?JSON.stringify(o,null,2):r;throw new Error(xu+" status code "+t+" and "+(i?"response body:\n"+i:"no response body."))}if(o){var a=o.warnings,u=void 0===a?[]:a,c=o.errors,s=void 0===c?[]:c;u.forEach((function(e){n.warn(xu+" warning:",e)})),s.forEach((function(e){n.error(xu+" non-fatal error:",e)}))}}}({logger:o}),v=function(e){var n=e.logger;return function(e){if(e){var t=e.split(";");if(t.length>=2&&t[1].length>0)try{var r=parseInt(t[1],10);if(!isNaN(r))return{regionId:r}}catch(e){}n.warn('Invalid adobe edge: "'+e+'"')}return{}}}({logger:o}),h=function(e){var n=e.extractEdgeInfo;return function(e){var t=e.content,r=void 0===t?{}:t,o=e.getHeader,i=r.handle,a=void 0===i?[]:i,u=r.errors,c=void 0===u?[]:u,s=r.warnings,d=void 0===s?[]:s;return{getPayloadsByType:function(e){return te(a.filter((function(n){return n.type===e})),(function(e){return e.payload}))},getErrors:function(){return c},getWarnings:function(){return d},getEdge:function(){return n(o("x-adobe-edge"))},toJSON:function(){return r}}}}({extractEdgeInfo:v}),y=qu({orgId:s,cookieJar:b}),w=function(e){var n=e.config,t=e.lifecycle,r=e.cookieTransfer,o=e.sendNetworkRequest,i=e.createResponse,a=e.processWarningsAndErrors,u=e.getLocationHint,c=e.getAssuranceValidationTokenParams,s=n.edgeDomain,d=n.edgeBasePath,l=n.datastreamId;return function(e){var n=e.request,f=e.runOnResponseCallbacks,p=void 0===f?he:f,g=e.runOnRequestFailureCallbacks,m=void 0===g?he:g,v=S();v.add(t.onResponse),v.add(p);var h=S();return h.add(t.onRequestFailure),h.add(m),t.onBeforeRequest({request:n,onResponse:v.add,onRequestFailure:h.add}).then((function(){var e=n.getUseIdThirdPartyDomain()?"adobedc.demdex.net":s,t=u(),i=t?d+"/"+t+n.getEdgeSubPath():""+d+n.getEdgeSubPath(),a=n.getDatastreamIdOverride()||l,f=n.getPayload();a!==l&&f.mergeMeta({sdkConfig:{datastream:{original:l}}});var p="https://"+e+"/"+i+"/v1/"+n.getAction()+"?configId="+a+"&requestId="+n.getId()+c();return r.cookiesToPayload(f,e),o({requestId:n.getId(),url:p,payload:f,useSendBeacon:n.getUseSendBeacon()})})).then((function(e){return a(e),e})).catch(Mu(h)).then((function(e){var n=e.parsedBody,t=e.getHeader,o=i({content:n,getHeader:t});return r.responseToCookies(o),v.call({response:o}).then(Nu)}))}}({config:t,lifecycle:u,cookieTransfer:f,sendNetworkRequest:g,createResponse:h,processWarningsAndErrors:m,getLocationHint:y,getAssuranceValidationTokenParams:Yu}),E=function(e){var n=e.cookieTransfer,t=e.lifecycle,r=e.createResponse,o=e.processWarningsAndErrors;return function(e){var i=e.request,a=e.responseHeaders,u=e.responseBody,c=e.runOnResponseCallbacks,s=void 0===c?he:c,d=e.runOnRequestFailureCallbacks,l=void 0===d?he:d,f=S();f.add(t.onResponse),f.add(s);var p=S();p.add(t.onRequestFailure),p.add(l);var g=function(e){return a[e]};return t.onBeforeRequest({request:i,onResponse:f.add,onRequestFailure:p.add}).then((function(){return o({statusCode:200,getHeader:g,body:JSON.stringify(u),parsedBody:u})})).catch(Mu(p)).then((function(){var e=r({content:u,getHeader:g});return n.responseToCookies(e),f.call({response:e}).then(Nu)}))}}({lifecycle:u,cookieTransfer:f,createResponse:h,processWarningsAndErrors:m}),I=function(e){var n=e.generalConsentState,t=e.logger,r=function(e,r){switch(e[qn]){case Nn:n.in(r);break;case Mn:n.out(r);break;case xn:n.pending(r);break;default:t.warn("Unknown consent value: "+e[qn])}};return{initializeConsent:function(e,n){n[qn]?r(n,jn):r(e,_n)},setConsent:function(e){r(e,Un)},suspend:function(){n.pending()},awaitConsent:function(){return n.awaitConsent()},withConsent:function(){return n.withConsent()},current:function(){return n.current()}}}({generalConsentState:Bn({logger:o}),logger:o}),C=function(e){var n=e.config,t=e.logger,r=e.lifecycle,o=e.consent,i=e.createEvent,a=e.createDataCollectionRequestPayload,u=e.createDataCollectionRequest,c=e.sendEdgeNetworkRequest,s=e.applyResponse,d=n.onBeforeEventSend,l=n.edgeConfigOverrides;return{createEvent:i,sendEvent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.edgeConfigOverrides,s=oc(n,Ru),f=Ut({payload:a(),localConfigOverrides:i,globalConfigOverrides:l}),p=u(f),g=S(),m=S();return r.onBeforeEvent(rc(rc({},s),{},{event:e,onResponse:g.add,onRequestFailure:m.add})).then((function(){return f.payload.addEvent(e),o.awaitConsent()})).then((function(){try{e.finalize(d)}catch(o){var n=function(){throw o};return m.add(r.onRequestFailure),m.call({error:o}).then(n,n)}if(!e.shouldSend()){m.add(r.onRequestFailure),t.info(Ou);var o=new Error(Ou);return m.call({error:o}).then((function(){}))}return c({request:p,runOnResponseCallbacks:g.call,runOnRequestFailureCallbacks:m.call})}))},applyResponse:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.renderDecisions,o=void 0!==t&&t,i=n.decisionContext,c=void 0===i?{}:i,d=n.responseHeaders,l=void 0===d?{}:d,f=n.responseBody,p=void 0===f?{handle:[]}:f,g=n.personalization,m=a(),v=u({payload:m}),h=S();return r.onBeforeEvent({event:e,renderDecisions:o,decisionContext:c,decisionScopes:[ir],personalization:g,onResponse:h.add,onRequestFailure:he}).then((function(){return m.addEvent(e),s({request:v,responseHeaders:l,responseBody:p,runOnResponseCallbacks:h.call})}))}}}({config:t,logger:o,lifecycle:u,consent:I,createEvent:Vn,createDataCollectionRequestPayload:_t,createDataCollectionRequest:xt,sendEdgeNetworkRequest:w,applyResponse:E});return function(e){var n=e.componentCreators,t=e.lifecycle,r=e.componentRegistry,o=e.getImmediatelyAvailableTools;return n.forEach((function(e){var n,t=e.namespace,i=o(t);try{n=e(i)}catch(e){throw De({error:e,message:"["+t+"] An error occurred during component creation."})}r.register(t,n)})),t.onComponentsRegistered({lifecycle:t}).then((function(){return r}))}({componentCreators:Su,lifecycle:u,componentRegistry:a,getImmediatelyAvailableTools:function(e){var r=i(e);return{config:t,componentRegistry:a,consent:I,eventManager:C,fireReferrerHideableImage:Wu,logger:r,lifecycle:u,sendEdgeNetworkRequest:w,handleError:Du({errorPrefix:"["+n+"] ["+e+"]",logger:r}),createNamespacedStorage:Uu,apexDomain:Gu}}})},setDebugCommand:function(e){r(e.enabled,{fromConfig:!1})},handleError:s,validateCommandOptions:Gn});return d};(Cu=window.__alloyNS)&&Cu.forEach((function(e){var n=Dn({console:Bu,locationSearch:window.location.search,createLogger:Pu,instanceName:e,createNamespacedStorage:Uu,getMonitors:Ju}),t=function(e){return function(n){var t=n[0],r=n[1],o=n[2],i=o[0],a=o[1];e(i,a).then(t,r)}}(Ku({instanceName:e,logController:n})),r=window[e].q;r.push=t,n.logger.logOnInstanceCreated({instance:t}),r.forEach(t)}))}function $u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Zu(e){if(e.__esModule)return e;var n=e.default;if("function"==typeof n){var t=function e(){return this instanceof e?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function ec(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function nc(e,n,t){return(n=uc(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function tc(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function rc(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tc(Object(t),!0).forEach((function(n){nc(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tc(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function oc(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(n.includes(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function ic(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,u=[],c=!0,s=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(r=i.call(t)).done)&&(u.push(r.value),u.length!==n);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,n)||sc(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ac(e){return function(e){if(Array.isArray(e))return ec(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||sc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uc(e){var n=function(e,n){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:n+""}function cc(e){return cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cc(e)}function sc(e,n){if(e){if("string"==typeof e)return ec(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ec(e,n):void 0}}
/*! js-cookie v3.0.5 | MIT */
function dc(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)e[r]=t[r]}return e}function lc(){if(!a){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");a=crypto.getRandomValues.bind(crypto)}return a(Ae)}function fc(e,n,t){if(Ne.randomUUID&&!n&&!e)return Ne.randomUUID();var r=(e=e||{}).random||(e.rng||lc)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){t=t||0;for(var o=0;o<16;++o)n[t+o]=r[o];return n}return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Re[e[n+0]]+Re[e[n+1]]+Re[e[n+2]]+Re[e[n+3]]+"-"+Re[e[n+4]]+Re[e[n+5]]+"-"+Re[e[n+6]]+Re[e[n+7]]+"-"+Re[e[n+8]]+Re[e[n+9]]+"-"+Re[e[n+10]]+Re[e[n+11]]+Re[e[n+12]]+Re[e[n+13]]+Re[e[n+14]]+Re[e[n+15]]).toLowerCase()}(r)}function pc(e){return Boolean(e&&void 0!==e.length)}function gc(){}function mc(e){if(!(this instanceof mc))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Ec(e,this)}function vc(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,mc._immediateFn((function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var r;try{r=t(e._value)}catch(e){return void yc(n.promise,e)}hc(n.promise,r)}else(1===e._state?hc:yc)(n.promise,e._value)}))):e._deferreds.push(n)}function hc(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===cc(n)||"function"==typeof n)){var t=n.then;if(n instanceof mc)return e._state=3,e._value=n,void wc(e);if("function"==typeof t)return void Ec(function(e,n){return function(){e.apply(n,arguments)}}(t,n),e)}e._state=1,e._value=n,wc(e)}catch(n){yc(e,n)}}function yc(e,n){e._state=2,e._value=n,wc(e)}function wc(e){2===e._state&&0===e._deferreds.length&&mc._immediateFn((function(){e._handled||mc._unhandledRejectionFn(e._value)}));for(var n=0,t=e._deferreds.length;n<t;n++)vc(e,e._deferreds[n]);e._deferreds=null}function bc(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function Ec(e,n){var t=!1;try{e((function(e){t||(t=!0,hc(n,e))}),(function(e){t||(t=!0,yc(n,e))}))}catch(e){if(t)return;t=!0,yc(n,e)}}function Ic(e){return"object"===cc(e)||void 0===e}function Cc(e){return"number"==typeof e}function Sc(e){return void 0===e}function kc(e,n){for(var t=0;t<n.length;t+=1)if(!Sc(e[n[t]]))return e[n[t]]}function Tc(e,n){for(var t=Object.keys(e),r=0;r<t.length;r+=1){var o=t[r],i=n.event;if((void 0===i?{}:i)[t[r]]!==e[o])return!1}return!0}function Dc(e,n){return{evaluate:function(e){return n.evaluate(e)},toString:function(){return"Condition{type="+e+", definition="+n+"}"}}}function Pc(e,n,t){return{evaluate:function(r){var o=function(e){return va[e]}(n);return!!o&&o.matches(r,e,t)}}}function Rc(e,n,t,r,o,i){return{evaluate:function(a){var u;return u=ma.ORDERED===i?function(e,n,t,r){var o=t;return e.every((function(e){var t=kc(e,ha);if(!t)return!1;var i=n.events[t];if(!i)return!1;var a=kc(e,ya);if(!a)return!1;var u=i[a];if(!Tc(e,u))return!1;if(null===u||Sc(u)||0===u.count)return!1;var c=(Sc(o)||u.timestamp>=o)&&(Sc(r)||u.timestamp<=r);return o=u.timestamp,c}))?1:0}(e,a,r,o):function(e,n,t,r){return e.reduce((function(e,o){var i=kc(o,ha);if(!i)return e;var a=n.events[i];if(!a)return e;var u=kc(o,ya);if(!u)return e;var c=a[u];if(!c)return e;if(!Tc(o,c))return e;var s=c.count,d=void 0===s?1:s;return Sc(t)||Sc(r)||c.timestamp>=t&&c.timestamp<=r?e+d:e}),0)}(e,a,r,o),function(e,n,t){switch(n){case pa.GREATER_THAN:return e>t;case pa.GREATER_THAN_OR_EQUAL_TO:return e>=t;case pa.LESS_THAN:return e<t;case pa.LESS_THAN_OR_EQUAL_TO:return e<=t;case pa.EQUALS:return e===t;case pa.NOT_EQUALS:return e!==t;default:return!1}}(u,n,t)}}}function Oc(e){return function(e,n){return{evaluate:function(t){return ga.AND===e?function(e,n){for(var t=!0,r=0;r<n.length;r+=1)t=t&&n[r].evaluate(e);return t}(t,n):ga.OR===e&&function(e,n){for(var t=!1,r=0;r<n.length;r+=1)if(t=t||n[r].evaluate(e))return!0;return!1}(t,n)}}}(e.logic,e.conditions.map(Ac))}function Ac(e){var n=e.type,t=e.definition;if(fa.MATCHER===n)return Dc(n,function(e){return Pc(e.key,e.matcher,e.values)}(t));if(fa.GROUP===n)return Dc(n,Oc(t));if(fa.HISTORICAL===n)return Dc(n,function(e){var n=e.events,t=e.from,r=e.to;return Rc(n,e.matcher,e.value,t,r,e.searchType)}(t));throw new Error("Can not parse condition")}function Nc(e){return function(e,n,t){return{id:e,type:n,detail:t}}(e.id,e.type,e.detail)}function Mc(e){var n=e.condition,t=e.consequences;return function(e,n){return{execute:function(t){return e.evaluate(t)?n:[]},toString:function(){return"Rule{condition="+e+", consequences="+n+"}"}}}(Ac(n),t.map(Nc))}function xc(e){var n=function(e){return function(e,n){return{version:e,rules:n}}(e.version,e.rules.map(Mc))}(e),t=n.version,r=n.rules;return{execute:function(e){return r.map((function(n){return n.execute(e)})).filter((function(e){return e.length>0}))},getVersion:function(){return t},numRules:function(){return r.length}}}}();
